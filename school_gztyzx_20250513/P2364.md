<h2>Description</h2>
现代计算机技术发展迅速，而在60余年前的二战之中，计算机技术就被广泛运用于战争，其中最著名的运用就是“密码术”，在历史的长河中，出现了许多优秀的加密解密算法，但是很多被破解了。在如今，RSA密码技术可以算是一个优秀、安全的算法。<br />
RSA算法非常简单，概述如下：<br />
<div>
	<br />
</div>
找两质数p和q，生成n=p×q，取t=(p-1)×(q-1)；取任何一个数e，要求满足e&lt;t并且e与t互质；取一个d，使得d×e mod t ＝1 。当然，d是可能大于t的。<br />
这样最终得到三个数：n、d、e ，即得到一对密匙：(n,d) , (n,e)。<br />
设：消息为一个数M (M&lt;n)；（文中^表示幂运算）<br />
设c=M^d mod n ，就得到了加密后的消息c ；<br />
设m=c^e mod n ，则必有 m＝M，从而完成对c的解密。<br />
在对称加密中：n、d两个数构成公钥，可以告诉别人；n、e两个数构成私钥，e自己保留，不让任何人知道。<br />
给别人发送的信息使用e加密，只要别人能用d解开就证明信息是由你发送的，构成了签名机制。别人给你发送信息时使用d加密，这样只有拥有e的你能够对其解密。<br />
RSA的安全性在于对于一个大数n，没有有效的方法能够将其分解，从而在已知n、d的情况下无法获得e；同样在已知n、e的情况下无法求得d。<br />
在加密过程中，最重要的是如何知道e求d（d与e事实上原理是相通的）<br />
要求e*d mod t=1，统一规划为e*d mod z=c (e、z、c皆为参数，d为所求)<br />
则存在f使得f*z+c=e*d，即f*z =e*d-c<br />
两边取e的模，得(f*z) mod e=e-(c mod e)，这里之所以用e-(c mod e)，是为了保证其为正。<br />
<p>
	又可化为f*(z mod e) mod e=e-(c mod e)，与之前e*d mod z=c形式相同，递归而求即可。直到e为1时，则取f为c或c+N×z（N为正整数）。
</p>
<p>
	对于给字符串加密解密的问题，我们可以这样解决：<br />
每次取字符串中的一个字符的ASCII值作为M进行计算，其输出为加密后16进制的数的字符串形式，按7字符表示，如E01E0A6；<br />
现在你作为盟军指挥部的一位程序员，负责与前线部队联系，长官为你提供了两个质数p、q和满足条件的e。<br />
现在你有两个任务：<br />
1、提供公钥d；2、为前线部队用d加密信息，并传送加密后字符串给指挥部。<br />
当然，为了安全性，长官要求你取得d必须大于10。并且长官提供的p与q可以保证，存在适合的d使得d&lt;10^9。
</p>
<h2>Input Format</h2>
一个数据文件共有x＋1行。<br />
第一行包含三个数字p、q、e、x，数字之间有空格。<br />
接下来的x行为x条通讯信息，由纯字符（包含标准ASCII中的大小写字母、数字、空格、符号等，其ASCII码值∈{a|32≤a≤127}）组成，每条通讯信息长度不超过250个字符；<br />
对于所有的q、p ，都满足13≤q≤10000，13≤p≤10000。<br />
并且1≤x≤200。<br />
<div>
	<br />
</div>
<h2>Output Format</h2>
你发出信息应该包括x行；<br />
第i行为第i条通讯信息通过公钥d加密后字符串，每一行行末都需要有换行符。<br />
我们的指挥部指战员会根据私钥成功地解码，并获得信息。<br />
<div>
	<br />
</div>
<pre><code class="language-input1">
13 17 175 2
I love Programming.
I hate study all time!
</code></pre><pre><code class="language-output1">
000006D000003B00000AD000001300000760000065000003B00000B4000000A00000130000067000000A00000A300000490000049000002800000CA000006700000D6
000006D000003B000001A00000A300000B50000065000003B000006A00000B500000C300000B2000002B000003B00000A300000AD00000AD000003B00000B50000028000004900000650000054
</code></pre>
<h2>Hint</h2>
数据样例说明<br />
这里<br />
n=p*q=221<br />
t=(p-1)*(q-1)=192<br />
由e=175可以得到d＝271是满足d*e mod t＝1的值。<br />
最终我们获得关键：<br />
n=221<br />
d=271<br />
e=175<br />
例如字符“I”，M=73，得73^271 mod 221=109，转换成16进制，为000006D。<br />
我们的指挥部部队指战员可以使用109^175 mod 221=73解密。<br />
<div>
	<br />
</div>
<h2>Source</h2>
数学推理