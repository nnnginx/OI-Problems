<h2>Description</h2>
为了报春日抢电脑的一箭之仇，电脑社团的同学向SOS团发起了挑战!他们声称:如果SOS团可以在最新的电脑游戏一一Sagittarius》 中取胜，就送给SOS团一人一台最新式电脑;反之SOS团要归还抢走的那台电脑。为了保护电脑，你一定要获胜!<br />
游戏《Sagittarius》是-一个多人闯关游戏，游戏有两个组成部分一一地图和关卡表。地图是一个n个节点的有根树，每个节点都有权值x[i]问，1号节点为根;关卡表是一个{1&#44;2.3...&#44;n}的排列a[i]。 每-一个回合中，系统会选取关卡表中一段连续的区间{a[l]&#44;a[l + 1]&#44;.....&#44;a[r]}&#44;设这些节点的最近公共祖先(LCA)为k，则这次游戏胜利的话玩家将会得到x[k]的收益。如果进行了多次游戏，同一个节点的收益可以被重复获得.<br />
春日和你的游戏技术都非常弱，但是SOS团中有一个人形自走挂:长门有希。因此你们每次都可以获胜。现在春日想要知道，对于所有不同的回合，你们可以获得的收益之和是多少?<br />
<div>
	<br />
</div>
<h2>Input Format</h2>
第一行一个数n&#44;表示节点的个数。<br />
第二行n- 1个数，第i个数是p[i + 1]。p[i]表示节点i的父亲是p[i].数据保证p[i] &lt; i。<br />
第三行n个数，a[1]&#44;a[2]&#44;..&#44;a[n]，表示关卡表。数据保证这是一个排列。<br />
第四行n个数，x[1]，x[2]&#44;....&#44; x[n]&#44;表示节点的权值。<br />
<div>
	<br />
</div>
<h2>Output Format</h2>
输出一个数表示答案。即对于所有可能的回合，你们能获得的总收益是多少。<br />

	<br />
<br />
<h3>
	<a class="ke-insertfile" href="/upload/file/20200131/20200131235129_72955.zip" target="_blank">样例下载</a>
</h3>
<pre><code class="language-input1">

</code></pre><pre><code class="language-output1">

</code></pre>
<h2>Hint</h2>
对于20%的数据，n≤100<br />
对于40%的数据，n≤2000<br />
对于60%的数据，n≤50000<br />
<div>
	对于另外20%的数据，排列a[i]是用如下的算法生成的:从一号点开始对树做dfs，到达一个节点的时候输出这个节点。
</div>
对于全部数据，n≤200000&#44;0&lt; x[i]≤10000&#44;p[i]&lt; i&#44; a[i]是一个排列。<br />
<div>
	<br />
</div>