## 问题描述

一个优秀的人工智能一定会高斯消元和仙人掌上 SG 函数计算吧。

这是一个双人信息对称博弈，两名玩家轮流游戏，每一次可以将棋子在图上任意沿一条边移动一步，然后可以选择结束这一局游戏。不能未移动就结束游戏。两人共享得分，每一步会使得分加上该边边权。若最后得分大于零，先手胜，否则后手胜。特别地，保证无边权和为零的环，分数达到正负无穷时游戏也会根据正负决定结果。

两人均非常聪明，求在每一个点作为起点时的胜负情况。

为了方便炼金，请在 $case=1$ 时输出最优策略时的分数。

不过为了为 NOI2077 复习，所有边权将由以下伪代码给出，其中 `//` 为整除：

```CPP
func f ( m ) :
    if m < 0 then :
		return - f ( - m )
    map < integar , bool > a
    for j := 1 to m then:
        if a[ m // j ] == false then :
            a[ m // j ] := 0x7f
			num := num + 1 
    return num
```

## 输入格式

一行三个整数 $n,m,case$ 表示点数、边数和是否输出分数。

接下来 $n-1$ 行，每行三个整数 $u_i,v_i,w_i$ 表示 $u_i$ 到 $v_i$  有一条无向边，边权为 $f(w_i)$ 。

## 输出格式

$n$ 行，每行一个字符串，表示起点为 $i$ 时的胜负情况。先手胜输出 `Misaka` ，先手败输出 `Chtholly` ，平局输出 `ccf` 。

```input1
2 1 1
1 2 1
```

```output1
Misaka 2
Misaka 2
```

```input2
3 3 114514
1 2 0
2 3 0
1 3 -1
```

```output2
ccf
ccf
ccf
```

## 数据范围

对于所有数据，满足 $n,m\leq5\times10^5,1\leq u,v\leq n,|w|\leq 10^{16}$ 。

保证图为联通仙人掌，且无重边、自环。

![](/upload/image/20220119/20220119151534_30314.png)

