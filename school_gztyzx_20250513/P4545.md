## 题目背景

可爱的 `Icy` 正在放暑假，因此她来找你打游戏啦。

## 题目描述

`Icy` 邀请你去和她玩一款解谜游戏。

这个游戏讲述了在高维宇宙中的微观粒子们的故事。

作为游戏背景，$n$ 个平行宇宙在开始时被生成，并被 $n-1$ 条双向的虫洞所互相连接，使得每两个宇宙都有且仅有一条路径能够互相到达。

虫洞是不稳定的，每个虫洞都存在一个视界维度 $v$。

一般来说，存在视界的虫洞是“不可穿越的”[$^{[1]}$](https://www.changhai.org/articles/science/physics/energy_condition/wormhole_2.php)，

但是我们认为，微观粒子是可以穿过的，并且每次经过一个虫洞，作为代价，这个微观粒子的维度可能会被提升，一个微观粒子经过若干连续的虫洞之后它的维度就会被提升至所有经过的虫洞的视界维度的最大值。

一个微观粒子在生成时是 0 维的，并且有一个起点和一个终点，在一个粒子从它的起点宇宙，经过最短虫洞路径，到达目标宇宙后，就会被 `Icy` 回收用以研究。

`Icy` 每次会通过粒子生成器，在每个宇宙中生成 $n$ 个微观粒子，这里面第 $i$ 个粒子的目的地是第 $i$ 号宇宙。

等待所有粒子旅行结束之后， `Icy` 会将他们全部回收，并选中一台维度仪，将这 $n^2$ 个粒子放进去。

`Icy` 拥有 $n$ 台大小不一的维度仪，它内部的构造是一个环状结构。

对于第 $i$ 台，这个环上存在 $i$ 个首尾相接的子胶囊，依次编号为 $1\sim i$，我们也称这一台维度仪的大小为 $i$，第 $1$ 个子胶囊的下一个子胶囊编号为 $2$，第 $2$ 个子胶囊的下一个子胶囊编号为 $3$，以此类推，第 $i$ 个子胶囊的下一个子胶囊编号为 $1$。

当一个微观粒子被扔入一台维度仪中时，它会被首先传送至编号为 $1$ 的子胶囊中。

接下来，在每个子胶囊中，每个粒子的维度降低一维，并被传送到下一个子胶囊里。同时所有维数等于 0 的粒子会被销毁，并记录下来。

`Icy` 每次可以选择一个子胶囊，并观测在里面销毁的粒子的数量。

`Icy` 要在这些苛刻的条件下，在 $m$ 次观测之内，探寻宇宙结构的真谛，并达到真正的 “永生”。

当然这些都是后话了， `Icy` 现在面临的问题是，由于这个游戏需要计算机能够流畅模拟多个高维平行宇宙中的微观粒子，但 `Icy` 的电脑搭载的却是[超级先进的i3-10100](https://www.intel.cn/content/www/cn/zh/products/sku/199283/intel-core-i310100-processor-6m-cache-up-to-4-30-ghz/specifications.html)。

显然这将会十分卡顿，因此她请求你写一个更快的版本，以便快速计算出反馈。

你将会得到：

高维宇宙之间的虫洞结构图，每个虫洞的视界宽度，以及每次 `Icy` 选择观测的维度仪和子胶囊编号。

你需要告知 `Icy`：

每次 `Icy` 观测到的结果。

---

你好！打扰一下，感谢你读到这里！>v<

鉴于出题人语文不是特别好，为了防止歧异等，这里提供一份[形式化题意](https://www.luogu.com.cn/paste/cx8dt3ht)，希望出题人拙劣的语文水平不会影响到您的做题体验！

## 输入格式

第一行一个数 $n,m$

接下来 $n-1$ 行，每行三个数 $x,y,z$，表示编号为 $x$ 的宇宙和编号为 $y$ 的宇宙之间有一条视界宽度为 $z$ 的虫洞连接。

接下来 $m$ 行，每行两个数 $x,y$，表示 `Icy` 选择编号(大小)为 $x$ 的维度仪，并且选择其中编号为 $y$ 的胶囊体进行观测。

## 输出格式

## 样例

```input1
5 4
1 2 4
1 3 2
2 4 1
2 5 3
5 1
5 3
3 2
4 1
```

```output1
5
2
14
17
```

## 样例解释

下面的表表示了每两个点之间对应的微观粒子的虫洞路径上的最高维度值：

/|1|2|3|4|5|
-|-|--|--|--|---
**1**|0|4|2|4|4|
**2**|4|0|4|1|3|
**3**|2|4|0|4|4|
**4**|4|1|4|0|3|
**5**|4|3|4|3|0|

统计一下可以得到：

```
1: 5
2: 2
3: 2
4: 4
5: 12
```

其中前面的数表示这个微观粒子最终会落在的子胶囊编号（不考虑环形的限制）。

对于第一次观测，观测到的结果就是 $5$。

对于第二次观测，同理观测到的结果为 $2$。

对于第三次观测，维度为 $5$ 的微观粒子会在旋转一圈之后重新回到子胶囊 $2$，所以观测到的结果是 $12+2=14$

对于第四次观测，维度为 $5$ 的微观粒子会在旋转一周之后重新回到子胶囊 $1$，所以观测到的结果是 $12+5=17$

## 提示

对于 $30\%$ 的数据，保证：$n,m,z_i\le10^2$

对于 $60\%$ 的数据，保证：$n,m,z_i\le10^3$

对于 $100\%$ 的数据，保证：$n,m,z_i\le10^5$，$y\le x\le n$

###### 实际上做出本题不需要任何有关物理学的知识，没有超纲，请放心开题。

## 后记

你写完了代码，准备发给 `Icy`

“啊？我都通关2遍了……我还以为你不想写了呢……”

“那我写的代码呢……？”

“额……要不，你删了？”

## 免责声明

> 请注意，本题出题人并未曾系统地学习过任何微观物理学理论。上述任何有关量子力学的描述并不保证符合任何现实世界的规律，也不保证它们实际上是存在的。本题题面中出现这些名词仅仅是为了辅助叙述题面，并不旨在产生任何的误导。题面中所有的内容仅仅在本题范围内有效，请不要轻易在本题以外的范围内使用或者信任题面中出现的内容。若在其他位置看到相似的叙述，纯属巧合，请不要将题面中提到的任何解释或者规律代入。在本文中使用的量子力学术语和概念纯属虚构，仅用于描述题意的目的。作者并非量子物理学专家，也未接受过相关系统培训。因此，任何关于量子力学的描述均不应被视为真实或具有科学依据。本文中的量子力学描述仅仅旨在为故事情节和主题提供支持和背景。这些描述不应被解读为对现实世界物理规律的任何准确反映，亦不应被认为具有科学上的可信度。本文仅在其创作范围内有效，读者不应将本文中的任何内容视为真实或可信的信息来源。如果本文中的术语或概念与其他作品或论述相似，纯属偶然。请在阅读和理解本文时，务必保持对科学和现实世界规律的正确认识。谨此声明，以免造成任何误解或混淆。
> 

