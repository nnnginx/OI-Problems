<p>Z 国有 $n$ 座城市，$n-1$ 条双向道路，每条双向道路连接两座城市，且任意两座城市都能通过若干条道路相互到达。</p>
<p>Z 国的国防部长小 Z 要在城市中驻扎军队。驻扎军队需要满足如下几个条件：</p>
<ul><li>一座城市可以驻扎一支军队，也可以不驻扎军队。</li>
<li>由道路直接连接的两座城市中至少要有一座城市驻扎军队。</li>
<li>在城市里驻扎军队会产生花费，在编号为 $i$ 的城市中驻扎军队的花费是 $p_i$。</li>
</ul><p>小 Z 很快就规划出了一种驻扎军队的方案，使总花费最小。但是国王又给小 Z 提出了 $m$ 个要求，每个要求规定了其中两座城市是否驻扎军队。小 Z 需要针对每个要求逐一给出回答。具体而言，如果国王提出的第 $j$ 个要求能够满足上述驻扎条件（不需要考虑第 $j$ 个要求之外的其它要求），则需要给出在此要求前提下驻扎军队的最小开销。如果国王提出的第 $j$ 个要求无法满足，则需要输出 $-1$。现在请你来帮助小 Z。</p>
<h2>输入格式</h2>
<p>第一行包含两个正整数 $n,m$ 和一个字符串 $\text{type}$，分别表示城市数、要求数和数据类型。$\text{type}$ 是一个由大写字母 <code>A</code>，<code>B</code> 或 <code>C</code> 和一个数字 $1$，$2$，$3$ 组成的字符串。它可以帮助你获得部分分。你可能不需要用到这个参数。这个参数的含义在「数据范围与提示」中有具体的描述。 </p>
<p>第二行 $n$ 个整数 $p_i$，表示编号 $i$ 的城市中驻扎军队的花费。  </p>
<p>接下来 $n-1$ 行，每行两个正整数 $u,v$，表示有一条 $u$ 到 $v$ 的双向道路。  </p>
<p>接下来 $m$ 行，第 $j$ 行四个整数 $a,x,b,y$ ($a \ne b$)，表示第 $j$ 个要求是在城市 $a$ 驻扎 $x$ 支军队，在城市 $b$ 驻扎 $y$ 支军队。其中，$x,y$ 的取值只有 $0$ 或 $1$：若 $x$ 为 $0$，表示城市 $a$ 不得驻扎军队，若 $x$ 为 $1$，表示城市 $a$ 必须驻扎军队；若 $y$ 为 $0$，表示城市 $b$ 不得驻扎军队，若 $y$ 为 $1$，表示城市 $b$ 必须驻扎军队。</p>
<p>输入文件中每一行相邻的两个数据之间均用一个空格分隔。</p>
<h2>输出格式</h2>
<p>输出共 $m$ 行，每行包含一个整数，第 $j$ 行表示在满足国王第 $j$ 个要求时的最小开销，如果无法满足国王的第 $j$ 个要求，则该行输出 $-1$。</p>


<pre><code class="language-input1">5 3 C3
2 4 1 3 9
1 5
5 2
5 3
3 4
1 0 3 0
2 1 3 1
1 0 5 0
</code></pre>
<pre><code class="language-output1">12
7
-1
</code></pre><h4>样例说明</h4>
<p>对于第一个要求，在 $4$ 号和 $5$ 号城市驻扎军队时开销最小。</p>
<p>对于第二个要求，在 $1$ 号、$2$ 号、$3$ 号城市驻扎军队时开销最小。</p>
<p>第三个要求是无法满足的，因为在 $1$ 号、$5$ 号城市都不驻扎军队就意味着由道路直接连接的两座城市中都没有驻扎军队。</p>
<h2>限制与约定</h2>
<p>对于全部数据，$1\le n,m\le 10^5,1\le p_i\le 10^5$。</p>
<div class="table-responsive">
<table class="table table-bordered table-text-center table-vertical-middle"><thead><tr><th>测试点编号</th>
    <th>$\text{type}$ </th>
    <th>$n=$ </th>
    </tr></thead><tbody><tr><td>$1,2$ </td>
    <td>A3</td>
    <td rowspan="2">$10$ </td>
  </tr><tr><td>$3,4$ </td>
    <td>C3</td>
  </tr><tr><td>$5,6$ </td>
    <td>A3</td>
    <td rowspan="2">$100$ </td>
  </tr><tr><td>$7$ </td>
    <td>C3</td>
  </tr><tr><td>$8,9$ </td>
    <td>A3</td>
    <td rowspan="2">$2\times 10^3$ </td>
  </tr><tr><td>$10,11$ </td>
    <td>C3</td>
  </tr><tr><td>$12,13$ </td>
    <td>A1</td>
    <td rowspan="7">$10^5$ </td>
  </tr><tr><td>$14\sim 16$ </td>
    <td>A2</td>
  </tr><tr><td>$17$ </td>
    <td>A3 </td>
  </tr><tr><td>$18,19$ </td>
    <td>B1 </td>
  </tr><tr><td>$20,21$ </td>
    <td>C1 </td>
  </tr><tr><td>$22$ </td>
    <td>C2 </td>
  </tr><tr><td>$23\sim 25$ </td>
    <td>C3</td>
    </tr></tbody></table></div>

<p>数据类型的含义：</p>
<p>A：城市 $i$ 与城市 $i+1$ 直接相连。  </p>
<p>B：任意城市与城市 $1$ 的距离不超过 $100$（距离定义为最短路径上边的数量），即如果这棵树以 $1$ 号城市为根，深度不超过 $100$。  </p>
<p>C：在树的形态上无特殊约束。  </p>
<p>1：询问时保证 $a=1,x=1$，即要求在城市 $1$ 驻军。对 $b,y$ 没有限制。  </p>
<p>2：询问时保证 $a,b$ 是相邻的（由一条道路直接连通）  </p>
<p>3：在询问上无特殊约束。</p>
<p><strong>时间限制：$\texttt{1s}$。</strong></p>
<p><strong>空间限制：$\texttt{512MB}$。</strong></p>
<h2>下载</h2>
<p><a href="./20846/file/attachment.zip">样例数据下载</a></p>
