<p><span style="font-size: small;"><span style="font-size: medium;"><span style="font-size: small;"><span style="font-family: verdana, geneva;"><span style="font-family: verdana, geneva;">After a long period working in his magical garden, Bratan&nbsp;</span>Mahammad<span style="font-family: verdana, geneva;"> could grow flowers of </span><strong>N</strong><span style="font-family: verdana, geneva;"> distinct kinds there. Since Tukezban's (</span>Mahammad's<span style="font-family: verdana, geneva;"> love) birthday is coming, as a perfect gift, </span>Mahammad<span style="font-family: verdana, geneva;"> wants to give her K bunches of flowers. Interestingly, each flower has a beautifulness x</span><sub>i</sub><span style="font-family: verdana, geneva;"> and the number of flowers of every kind is </span><strong>M</strong><span style="font-family: verdana, geneva;">. When preparing flower buckets, he has to be very careful: every bucket must consist of </span><strong>N</strong><span style="font-family: verdana, geneva;"> flowers and surely, all flowers have to be&nbsp;distinct kind in each bucket. The overall beauty value of </span><strong>K</strong><span style="font-family: verdana, geneva;"> buckets depends on the absolute difference between the beautifulness of the most beautiful flower of K buckets (</span><em><span style="font-family: verdana, geneva;">max(x</span><sub><span style="font-size: x-small;">i</span></sub><span style="font-family: verdana, geneva;">)</span></em><span style="font-family: verdana, geneva;">) and the least beautiful one (</span><em><span style="font-family: verdana, geneva;">min(x</span><sub><span style="font-size: x-small;">i</span></sub><span style="font-family: verdana, geneva;">)</span></em><span style="font-family: verdana, geneva;">). Help </span>Mahammad<span style="font-family: verdana, geneva;">&nbsp;minimize this difference.</span></span></span></span></span></p>
<h3><span style="font-size: large;"><span style="font-family: &quot;times new roman&quot;, times;">Input</span></span></h3>
<p><span style="font-size: small;"><span style="font-size: medium;"><span style="font-size: small;"><span style="font-family: verdana, geneva;"><span style="font-family: verdana, geneva;">The first line of the input contains 3 positive integers, </span><strong>N, M </strong><strong>and</strong><strong> K</strong><span style="font-family: verdana, geneva;">, denoting the number of flower types, the number of flowers in each type, and the number of buckets needed, respectively. Then, the following N lines have 4 integers each, </span><em><span style="font-family: verdana, geneva;">x</span><sub><span style="font-size: x-small;"><sub>i,1</sub>,</span></sub><span style="font-family: verdana, geneva;">&nbsp;a</span><sub><span style="font-size: x-small;"><sub>i</sub>,</span></sub><span style="font-family: verdana, geneva;">&nbsp;b</span><sub><span style="font-size: x-small;"><sub>i</sub>,</span></sub><sub>&nbsp;</sub><span style="font-family: verdana, geneva;">c</span><sub><span style="font-size: x-small;">i</span></sub></em><span style="font-family: verdana, geneva;">.</span></span></span></span></span></p>
<p><span style="font-size: small;"><span style="font-size: medium;"><span style="font-size: small;"><span style="font-family: verdana, geneva;"><span style="font-family: verdana, geneva;">Here </span><em><span style="font-family: verdana, geneva;">x</span><sub><span style="font-size: x-small;">i,1</span></sub></em><span style="font-family: verdana, geneva;">&nbsp;indicates the beautifulness of the first flower in i-th&nbsp;type. And for remaining M - 1 flowers, beautifulness value is calculated as </span><em><span style="font-family: verdana, geneva;">x</span><sub><span style="font-size: x-small;">i, j</span></sub><span style="font-family: verdana, geneva;">&nbsp;= (a</span><sub><span style="font-size: x-small;">i </span></sub><span style="font-family: verdana, geneva;">* x</span><span style="font-size: x-small;"><sub>i, j</sub><sub>-1</sub></span><span style="font-family: verdana, geneva;">&nbsp;+ b</span><sub><span style="font-size: x-small;">i</span></sub><span style="font-family: verdana, geneva;">) % c</span><sub><span style="font-size: x-small;">i</span></sub></em><span style="font-family: verdana, geneva;">&nbsp;.</span></span></span></span></span></p>
<p><span style="font-size: small;"><span style="font-size: medium;"><span style="font-size: small;"><span style="font-family: verdana, geneva;">You can safely assume that&nbsp; <strong>N, M, K ¡Ü 2500 </strong>and<strong> K </strong><strong>¡Ü M</strong>. <em>All numbers in input section fit 32-bit signed nonnegative integers.</em></span></span></span></span></p>
<h3><span style="font-family: &quot;times new roman&quot;, times;">Output</span></h3>
<p><span style="font-size: small;"><span style="font-size: medium;"><span style="font-size: small;">Print the <em>minimum possible difference in K-buckets</em>.&nbsp;</span></span></span></p>
<h3><span style="font-family: &quot;times new roman&quot;, times;">Example</span></h3>
<pre><p><strong><span style="font-family: &quot;times new roman&quot;, times;">Input:</span></strong></p><span style="font-size: medium;"><span style="font-size: small;">2 3 2
2 2 3 9
2 1 2 10 </span></span><span style="font-family: &quot;times new roman&quot;, times;">
</span></pre>
<pre><p><strong><span style="font-family: &quot;times new roman&quot;, times;">Output:</span></strong></p><span style="font-size: medium;"><span style="font-size: small;">4</span></span>
</pre>
<p><strong><span style="font-family: &quot;times new roman&quot;, times;">Note:</span></strong></p>
<p>The generated beauty values will be:</p>
<p>For i = 1: (2, 7, 8)</p>
<p>For i = 2: (2, 4, 6)</p>
<p>One optimal way is to choose buckets as (7, 4) and (8, 6) together, so the difference is |8 - 4| = 4</p>
<p>By the way, we should not choose (2, 4) and (7, 2), since |7 - 2| = 5, which is greater than 4.</p>