<p>&nbsp;</p>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">UCF is now the nation¡¯s second largest university in student population. &nbsp;To meet the demands&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">of a growing student body, the university is always constructing new buildings. &nbsp;One of the&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">issues is the campus needs many new buildings but has limited space. &nbsp;To help make room for&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">new buildings, a new restructuring method is being used!</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">Each day (until the end of restructuring) a building is selected for ¡°reconstruction¡±. During&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">reconstruction, all buildings that are connected to the selected building and only to the selected&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">building are combined into (torn down and then added as new parts to) the selected building.&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">Every building has a given cost associated with applying this reconstruction operation; when a&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">building is selected and other buildings are combined with it, the cost associated with the&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">selected building is the cost for combining the selected group of buildings.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">For example, in the building layout below, the building with cost 5 is selected in Day 1. The&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">building with cost 1 (crossed out in the picture in Day 1) is the only building connected to the&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">selected building and this building is connected to no other building. These two buildings are&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">combined and the cost of the operation is 5 (the cost of the selected building). In Day 2, the&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">building with cost 4 is selected (hence the cost 4 for combining) and in Day 3, the building with&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">cost 6 is selected. No more buildings can be selected after Day 3 since every building is&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">connected to more than one building. The total cost for this sequence of combinations is&nbsp;</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">therefore 5+4+6= 15.</div>
<p class="MsoNormal"><span style="font-size: small;">UCF is now the nation¡¯s second largest university in student population.&nbsp; To meet the demands </span></p>
<p class="MsoNormal"><span style="font-size: small;">of a growing student body, the university is always constructing new buildings.&nbsp; One of the </span></p>
<p class="MsoNormal"><span style="font-size: small;">issues is the campus needs many new buildings but has limited space.&nbsp; To help make room for </span></p>
<p class="MsoNormal"><span style="font-size: small;">new buildings, a new restructuring method is being used!</span></p>
<p class="MsoNormal"><span style="font-size: small;">Each day (until the end of restructuring) a building is selected for ¡°reconstruction¡±. During </span></p>
<p class="MsoNormal"><span style="font-size: small;">reconstruction, all buildings that are connected to the selected building and only to the selected </span></p>
<p class="MsoNormal"><span style="font-size: small;">building are combined into (torn down and then added as new parts to) the selected building. </span></p>
<p class="MsoNormal"><span style="font-size: small;">Every building has a given cost associated with applying this reconstruction operation; when a </span></p>
<p class="MsoNormal"><span style="font-size: small;">building is selected and other buildings are combined with it, the cost associated with the </span></p>
<p class="MsoNormal"><span style="font-size: small;">selected building is the cost for combining the selected group of buildings.</span></p>
<p class="MsoNormal"><span style="font-size: small;">For example, in the building layout below, the building with cost 5 is selected in Day 1. The </span></p>
<p class="MsoNormal"><span style="font-size: small;">building with cost 1 (crossed out in the picture in Day 1) is the only building connected to the </span></p>
<p class="MsoNormal"><span style="font-size: small;">selected building and this building is connected to no other building. These two buildings are </span></p>
<p class="MsoNormal"><span style="font-size: small;">combined and the cost of the operation is 5 (the cost of the selected building). In Day 2, the </span></p>
<p class="MsoNormal"><span style="font-size: small;">building with cost 4 is selected (hence the cost 4 for combining) and in Day 3, the building with </span></p>
<p class="MsoNormal"><span style="font-size: small;">cost 6 is selected. No more buildings can be selected after Day 3 since every building is </span></p>
<p class="MsoNormal"><span style="font-size: small;">connected to more than one building. The total cost for this sequence of combinations is&nbsp;</span></p>
<p class="MsoNormal"><span style="font-size: small;">therefore 5+4+6= 15.</span></p>
<p class="MsoNormal"><img src="file://z1RtgMTG.png" alt="" width="915" height="246"></p>
<p>&nbsp;</p>
<h3>
<p style="font-size: 10px; font-weight: normal;"><strong>The Problem:</strong></p>
<p>&nbsp;</p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">Given the building connections and the costs associated with refactoring the buildings, determine&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">the minimum possible number of buildings that will be left when refactoring is complete, the&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">minimum cost of achieving this minimum size and the number of ways to achieve this minimum&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">cost with minimum size. &nbsp;Two ways are considered different if on the i-</span><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">th&nbsp;</span><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">day the building being&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">reconstructed is different or the number of days to complete the reconstruction differs. &nbsp;Since the&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif; font-weight: normal;">number of ways to reconstruct the university can be quite large, print the result modulo</span></p>
<p class="MsoNormal" style="margin-bottom: 0.0001pt; background-image: initial; background-attachment: initial; background-size: initial; background-origin: initial; background-clip: initial; background-position: initial; background-repeat: initial;"><span style="font-size: 9pt; font-family: Verdana, sans-serif;"><span style="font-weight: normal;">1,000,000,007.</span><strong>&nbsp;</strong></span></p>
<p class="MsoNormal">&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
</h3>
<h3>Input</h3>
<p><span style="font-size: small;">The first input line contains a positive integer, n, indicating the number of restructurings to&nbsp;</span></p>
<p><span style="font-size: small;">perform. &nbsp;Each restructuring will contain multiple lines. The first line contains two integers,</span></p>
<p><span style="font-size: small;">b (1 ¡Ü b ¡Ü 500) and c (1 ¡Ü c ¡Ü 2000), representing (respectively) the number of buildings and the&nbsp;</span></p>
<p><span style="font-size: small;">number of connections between them. &nbsp;The next line contains b integers, wi (1 ¡Ü wi ¡Ü 500),&nbsp;</span></p>
<p><span style="font-size: small;">representing the cost of performing a reconstruction on the i-th selected building. &nbsp;The next c lines&nbsp;</span></p>
<p><span style="font-size: small;">each contain two integers, xi and yi (1 ¡Ü xi ¡Ü b, 1 ¡Ü &nbsp;yi ¡Ü b, xi ¡Ù yi), representing two identifiers for buildings that connect. &nbsp;There will be at most one direct connection between any two buildings.</span></p>
<p><span style="font-size: small;">Also, every pair of buildings will be directly or indirectly connected.</span></p>
<h3>Output</h3>
<p><span style="font-size: small;">For each restructuring, first output the heading ¡°Case #d: ¡±, where d is the test case number,&nbsp;</span></p>
<p><span style="font-size: small;">starting with 1. &nbsp;Then, print three integers separated by a single space: the minimum number of&nbsp;</span></p>
<p><span style="font-size: small;">buildings left, the minimum cost for achieving this configuration, and the number of ways to&nbsp;</span></p>
<p><span style="font-size: small;">achieve the minimum cost with minimum size. Follow the format illustrated in Sample Output.</span></p>
<h3>Example</h3>
<pre><strong>Input:</strong>
3
3 2
1 2 3
3 1
3 2
8 7
80 4 3 2 1 90 5 80
1 2
2 3
3 4
4 5
5 6
4 7
7 8
8 8
1 5 6 1 1 4 1 9
1 2
2 3
3 4
4 2
3 6
6 7
6 5
6 8

<strong>Output:</strong></pre>
<pre>Case #1: 1 3 1
Case #2: 1 15 28
Case #3: 3 15 3
</pre>