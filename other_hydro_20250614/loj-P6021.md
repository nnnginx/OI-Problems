## 题目描述

> 没有常人知道她在哪里――LCR 的神秘只有真正的神牟拍芸吹健  
> 幸运的是，某附中确实存在一个这样的神摹Ｒ惶欤神姆⑾至艘患事情：LCR 从自己的视野中消失了。  
> 显然，这不可能是因为神谋淙醵失去了 LCR 的青睐，而是 LCR 离开了这座城市的缘故。  
> 神奶ど狭搜罢 LCR 的征程。  
> 神淖吖了千山万水，一天，他遇到了 LCR 的兄长――LCT。LCT 告诉他，他的身上沾染了过多的Xm气息，因此看不到 LCR。LCT 还告诉他，他需要到东海找龙王消除自己身上的Xm气息。  
> 神闹道，普通的Xm是不可能在他这样的神纳砩狭粝律Xm气息的，只有像 LCA 这样的Xm才会在他的身上留下Xm气息。  
> 神木龆ǔ时空传送去东海。神南衷谝传送到一个有 $n$ 个传送点的网络中，传送网络中有 $m$ 条路，但神姆⑾置刻趼飞隙加兄辽僖桓鱿 LCA 那样的Xm。神闹道，自己如果沾染了过多的Xm气息，就会即使到了东海也无法消除了。根据Xm学第二定律，Xm气息只会从Xm多的地方向Xm少的地方传递，因此神脑诖┕一条路后，他身上的Xm气息会变成穿过之前的值和这条路径上的Xm数量的最大值。神幕狗⑾郑在不同的时间，他的家乡和东海对应的传送网络的传送点是不同的。神南胫道，如果他知道自己应该从哪里进入排序网络和从何处离开，他至少要沾染多少Xm气息。由于传送网络中的Xm气息太过浓郁，你可以认为神脑诮入时身上没有Xm气息。保证传送网络中任意两点相互可达，且道路是双向的。一条道路连接的必定是两个不同的传送点，但一对传送点之间可能有两条道路。

给你一个 $n$ 个点 $m$ 条边的无向连通图，编号为 $1$ 到 $n$ ，没有自环，可能有重边，每一条边有一个正权值 $w$ 。给出 $q$ 个询问，每次给出两个不同的点 $u$ 和 $v$ ，求一条从 $u$ 到 $v$ 的路径上边权的最大值最小是多少。

## 输入格式

输入第一行两个整数 $n$，$m$。

接下来 $m$ 行，每行三个整数 $a_i,b_i,w_i$（$a_i\neq b_i$），表示一条连接传送点 $a_i$ 和 $b_i$ 的道路，上面的Xm数量为 $w_i$。

接下来一行一个整数 $q$，表示询问数量。

接下来一行四个整数 $A,B,C,P$，表示询问的生成方式。

由于本题数据规模极大，直接输入输出会占用比计算多数倍的时间，因此对询问的输入输出进行了压缩。

输入压缩方法是：读入四个整数 $A,B,C,P$，每次询问调用以下函数生成 $u$ 和 $v$：

```cpp
int A, B, C, P;

int rnd() {
    return A = (A * B + C) % P;
}
```

每次询问时的调用方法为：

```cpp
u = rnd() % n + 1, v = rnd() % n + 1;
```

若 $u$ 和 $v$ 相等则答案为 $0$。

数据保证 $0\leq A<P,0\leq C<P,P(B+1)<2^{31}-1$。

## 输出格式

输出共一行一个整数，表示所有询问的答案之和模 $1000000007$ 的值。

由于本题数据规模极大，直接输入输出会占用比计算多数倍的时间，因此对询问的输入输出进行了压缩。

输出压缩方法是：输出所有询问的答案之和模 $1000000007$ 的值。

```input1
5 7
1 2 8
2 3 9
3 1 2
3 4 7
1 4 4
3 5 6
1 4 9
10
233 17 66666 19260817
```

```output1
32
```

## 数据范围与提示

<!-- https://ooo.0o0.ooo/2017/04/16/58f2e0cdda24f.bmp -->

| 测试点编号 |   $n$   |   $m$    |    $q$     |         $w$          |    备注     |
| :--------: | :-----: | :------: | :--------: | :------------------: | :---------: |
|    $1$     |  $100$  |   $99$   |   $100$    |  $1\le w_i\le 10^3$  | $a_i=b_i-1$ |
|    $2$     |  $100$  |   $99$   |   $100$    |  $1\le w_i\le 10^3$  |             |
|    $3$     |  $100$  |  $200$   |   $100$    |  $1\le w_i\le 10^3$  |             |
|    $4$     | $2000$  |  $1999$  |   $2000$   |  $1\le w_i\le 10^3$  | $a_i=b_i-1$ |
|    $5$     | $2000$  |  $1999$  |   $2000$   |  $1\le w_i\le 10^3$  |             |
|    $6$     | $2000$  |  $5000$  |   $2000$   |  $1\le w_i\le 10^3$  |             |
|    $7$     | $10000$ |  $9999$  |  $200000$  |  $1\le w_i\le 10^3$  |             |
|    $8$     | $10000$ | $30000$  |  $200000$  |  $1\le w_i\le 10^3$  |             |
|    $9$     | $30000$ | $29999$  |  $200000$  |  $1\le w_i\le 10^3$  | $a_i=b_i-1$ |
|    $10$    | $30000$ | $50000$  |  $200000$  |  $1\le w_i\le 10^3$  |             |
|    $11$    | $40000$ | $39999$  |  $500000$  | $1\le w_i\le 10^9+7$ |             |
|    $12$    | $40000$ | $80000$  |  $500000$  | $1\le w_i\le 10^9+7$ |             |
|    $13$    | $70000$ | $69999$  |  $500000$  | $1\le w_i\le 10^9+7$ |             |
|    $14$    | $70000$ | $100000$ |  $500000$  | $1\le w_i\le 10^9+7$ |             |
|    $15$    | $70000$ | $69999$  | $5000000$  | $1\le w_i\le 10^9+7$ | $a_i=b_i-1$ |
|    $16$    | $70000$ | $69999$  | $7000000$  | $1\le w_i\le 10^9+7$ |             |
|    $17$    | $70000$ | $69999$  | $10000000$ | $1\le w_i\le 10^9+7$ |             |
|    $18$    | $70000$ | $100000$ | $5000000$  | $1\le w_i\le 10^9+7$ |             |
|    $19$    | $70000$ | $100000$ | $7000000$  | $1\le w_i\le 10^9+7$ |             |
|    $20$    | $70000$ | $100000$ | $10000000$ | $1\le w_i\le 10^9+7$ |             |



对于 $100\%$ 的数据，$n\leq 70000$，$m\leq 100000$，$q\leq 10^7$。

