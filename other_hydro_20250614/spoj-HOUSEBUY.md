<!-- p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Helvetica} span.s1 {font: 7.0px Helvetica} -->
<p>Bill and Scott are business rivals. Each of them wishes to buy a house in Javaville, but they want to live as far away from eachother as possible. Since Javaville is a relatively new town, there areno maps available yet; instead, information about homes and other buildings has been collected by word of mouth and provided to both Bill and Scott. This information consists of building addresses and distances between buildings. All of the information is consistent, although it may be incomplete or redundant.</p>
<p>The streets in Javaville are laid out in a rectangular grid of <strong>m</strong> east/west streets (named <strong>＆A ＊, ＆B ＊, ＆C ＊</strong>, ＃) and <strong>n</strong> &nbsp;north/south streets (numbered ＆<strong>0 ＊, ＆1 ＊, 2 ＊</strong>, ＃), where <strong>m</strong>&nbsp; and <strong>n</strong>&nbsp; are each between 2 and 10. Every building (either a house or some other building, such as a post office or school) in Javaville is at the intersection of two streets, and no two buildings are located at the same intersection. Some intersections have no buildings at all. All distances are measured in terms of the smallest number of whole blocks that must be traversed north, south, east, and/or west to get from one intersection to another intersection.</p>
<p>Here is some sample information that might be provided to Bill and Scott by various reliable sources:</p>
<p>每 There are 5 east/west streets and 5 north/south streets.</p>
<p>每 House1 is located at intersection <strong>A0</strong></p>
<p>每 The post office is located at intersection <strong>A4</strong></p>
<p>每 The school is at a distance of 4 blocks from house1</p>
<p>每 House2 is at a distance of 6 blocks from the post office</p>
<p>每 The school is at a distance of 6 blocks from the post office</p>
<p>每 House3 is at a distance of 6 blocks from the post office</p>
<p>From this we can see that there are two possible maps of Javaville 〞 see Figure 1.</p>
<p><img src="file://zLhUvkkd.png" alt="Javaville, 2 possibilities for test case 1" width="537" height="263"></p>
<p><strong><span style="font-size: medium;">Figure 1:</span></strong> <strong><span style="font-size: medium;">h1,h2,h3 = houses, P = postoffice, S = school</span></strong></p>
<p>We see that the locations of house1, the post office, and the school are fixed, but house2 could beat either C0&nbsp; or E2 , and house3 could be at either C0&nbsp; or E2 . Clearly there is always a pair of housesseparated by 6 blocks (house1 is always 6 blocks from the furthest house), but the best distance wecan guarantee for any specific pair&nbsp; of houses is 4 (since house2 is always 4 blocks away from house3). We would report this information to Bill and Scott, telling them that, even though a separation of 6 is always achievable, the safest recommendation that we are able to make for specific houses is to have one of them purchase house2 and have the other purchase house3. (We assume that Bill and Scott will consult with one another before purchasing their houses in order to guarantee that one of our recommendations is followed.)</p>
<p>Bill and Scott would like you to write a program that will take location and distance information about buildings and determine two quantities, <strong>D</strong>&nbsp; and <strong>D∩ </strong>. <strong>D</strong>&nbsp; is the minimum, over all possible valid arrangements of buildings, of the largest house separation in each arrangement. <strong>D∩</strong>&nbsp; is the maximum value for which there exists at least one pair of houses <strong>i</strong>&nbsp; and <strong>j</strong>&nbsp; that are guaranteed to be separated by a distance of at least <strong>D∩</strong> . In the latter case, you should list all pairs of houses that are guaranteed to be separated by at least <strong>D∩</strong>&nbsp; blocks.</p>
<p>More precisely,</p>
<p>Define the diameter <strong>d(S)</strong> of a feasible urban layout <strong>S</strong> as the distance between the two most distant residential homes in the layout.  For the two residential houses&nbsp;<strong>i</strong>, <strong>j</strong>, define their safety factor:&nbsp;<strong>e[i, j]</strong> is defined as the minimum value of the distance between residential houses <strong>i </strong>and <strong>j</strong> in all feasible urban layouts.  Bill and Scott want you to write a program that calculates <strong>D</strong> and <strong>D'</strong> based on the information they collect, where <br><br><strong>D = min {d (S)} over all layouts </strong><strong><strong>S</strong></strong>;<br> <strong>D' = max {e [i, j]} over all pairs (i, j)</strong>. <br><br>At the same time you also have to give the safest purchase recommendations: that is, all pairs <strong>(i,j)</strong> meeting <strong>e [i, j] = D'</strong> for residential houses <strong>i </strong>and <strong>j</strong>.<br>For the above example, the first layout has&nbsp;<strong>d (S1)</strong> = 6, while the second layout has&nbsp;<strong>d (S2)</strong> = 6. The safety factor between each two residential houses is respectively:&nbsp;</p>
<p><strong>e [1,2]</strong> = 2, <strong>e [1,3]</strong> = 2, <strong>e [2,3]</strong> = 4. Then, <br><strong>D = min {d (S1), d (S2)}</strong> = 6, and&nbsp;<br><strong>D' = max {e [1,2], e [1,3], e [2,3]}</strong> = Purchase recommendations are: house 2 and house 3.</p>
<p>&nbsp;</p>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 601.333px; width: 1px; height: 1px; overflow: hidden;">The diameter d (S) of a feasible urban layout S is defined as the distance between the two most distant homes in the layout.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 601.333px; width: 1px; height: 1px; overflow: hidden;">For the two residential buildings i, j, their safety factor e [i, j] is defined as the minimum value of the distance between residential i and j in all feasible urban layouts.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 601.333px; width: 1px; height: 1px; overflow: hidden;">Bill and Scott want you to write a program that calculates D and E based on the information they collect. Where D = min {d (S)}; E = max {e [j, j]}. At the same time you have to give the safest purchase recommendations, that is, all meet e [i, j] = E residential i, j.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 601.333px; width: 1px; height: 1px; overflow: hidden;">For the above example, the first layout of d (S1) = 6, the second layout of d (S2) = 6. The safety factor between each two dwellings is: e [1,2] = 2, e [1,3] = 2, e [2,3] = 4. Then, D = min {d (S1), d (S2)} = 6, E = max {e [1,2], e [1,3], e [2,3]} = Purchase recommendations are: residential 2 and residential 3.</div>
<h3>Input</h3>
<!-- p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Helvetica} -->
<p>&nbsp;The input will consist of one or more descriptions. Each description will begin with a line containing two positive integers, <strong>m</strong>&nbsp; and <strong>n</strong> , representing the number of blocks in each direction (2 ≒&nbsp;<strong>m, n</strong> ≒10 ). &nbsp;Each description will end with a line containing the single word ＆<strong>END</strong>＊ in uppercase. The entire data set will end with a line containing a pair of zeros.</p>
<p>The remaining lines in each data set will be in one of the following two formats:</p>
<p>name <strong>LOCATION</strong> r c</p>
<p>&nbsp;or</p>
<p>name <strong>DISTANCE</strong> d name2</p>
<p>&nbsp;where name&nbsp; and name2&nbsp; are strings containing only digits and lowercase alphabetic characters, each of length at most 10; r is an uppercase letter between ＆A ＊ and ＆J ＊; c&nbsp; is a digit; and d is a positive integer. &nbsp;If the first five characters of a name&nbsp; are the lowercase letters ＆house ＊ then it is a candidate for selection as a home for Bill or Scott; otherwise it stands for some non-residential building. In a ＆<strong>DISTANCE</strong>＊ specification, name2 will always be the name of some building that has occurred previously in this data set as the first name&nbsp; on one of the data lines (in other words, there are no forward references to buildings in ＆<strong>DISTANCE</strong>＊ constraints). Each description is consistent (i.e., there is at least one way to lay out the houses and other buildings in a way consistent with the description). Each description will include information about at least two distinct houses. At most <strong>25</strong> distinct building names will occur in each description, and there will be at most <strong>50</strong> constraints (<strong>＆LOCATION</strong>＊ or ＆<strong>DISTANCE</strong>＊) for each description.</p>
<h3>Output</h3>
<!-- p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 10.0px Helvetica} span.s1 {font: 7.0px Helvetica} -->
<p>&nbsp;For each description, the output will consist of <strong>D</strong>, followed by value of <strong>D'</strong>, and then a list of all pairs of houses with maximum guaranteed separation <strong>D∩</strong>&nbsp; (which might be smaller than the maximum achievable separation). No pair of houses should be listed more than once. The output should be labeled exactly as shown in the sample output below, with a blank line separating the outputs for consecutive data sets. In each pair, houses should be ordered according to the first time they appear in the input; the list of pairs should be ordered in the same way, sorted by the first element of the pair, then by the second element.</p>
<h3>Example</h3>
<pre><strong>Input:</strong>
<p>5 5<br>house1 LOCATION A 0<br>postoffice LOCATION A 4<br>school DISTANCE 4 house1<br>house2 DISTANCE 6 postoffice<br>school DISTANCE 6 postoffice<br>house3 DISTANCE 6 postoffice<br>END<br>10 10<br>house1 LOCATION A 0<br>building2 DISTANCE 12 house1<br>building2 DISTANCE 12 house1<br>house3 DISTANCE 7 house1<br>building4 DISTANCE 2 house3<br>building4 DISTANCE 7 building2<br>building4 DISTANCE 2 house3<br>house5 DISTANCE 6 building4<br>building6 DISTANCE 10 building2<br>building6 DISTANCE 5 building4<br>building6 DISTANCE 2 house1<br>house7 DISTANCE 1 house1<br>house7 DISTANCE 1 house1<br>building8 DISTANCE 10 house7<br>house9 DISTANCE 10 building2<br>house9 DISTANCE 3 building4<br>building10 DISTANCE 5 house3<br>building10 DISTANCE 5 house3<br>house11 DISTANCE 3 building2<br>building12 DISTANCE 7 house7<br>building12 DISTANCE 8 house1<br>building12 DISTANCE 9 building4<br>building12 DISTANCE 3 house5<br>house13 DISTANCE 7 building8<br>house13 DISTANCE 3 house5<br>building14 DISTANCE 2 building10<br>building14 DISTANCE 9 building8<br>house15 DISTANCE 12 building8<br>house15 DISTANCE 11 building12<br>house15 DISTANCE 9 building2<br>house15 DISTANCE 7 house13<br>building16 DISTANCE 6 building10<br>building16 DISTANCE 3 house11<br>building16 DISTANCE 12 house9<br>building16 DISTANCE 5 house7<br>house17 DISTANCE 4 house11<br>house17 DISTANCE 3 building12<br>building18 DISTANCE 8 building14<br>building18 DISTANCE 10 building6<br>building18 DISTANCE 8 building14<br>building18 DISTANCE 10 building6<br>house19 DISTANCE 2 house13<br>house19 DISTANCE 6 building18<br>house19 DISTANCE 1 house5<br>building20 DISTANCE 8 building14<br>END<br>0 0</p></pre>
<pre><strong>Output:<br></strong>6 4<br>house2 house3<br>9 9<br>house1 house11<br>house5 house9<br>house9 house11<br>house9 house17</pre>