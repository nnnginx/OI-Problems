## 题目描述
彼得是一位生物W家。有次他在晒PY料中分析同一群F存物N集合 $\Sigma = \{1, 2, \ldots, n\}$ g的演化PS，s得到了不太一拥难莼洌想知道@煽醚莼涞念似程度。

一棵演化 $T$ 是一棵o向o根 (undirected, unrooted tree)，其中~c楝F存物N $1, 2, \ldots, n$，其他ct橐缃^物N。O $v \in V(T)$，我用 $\deg(v)$ 肀硎九cc $v$ 相的c怠Ｔ谝豢醚莼渲校每代表已缃^物N的c $v$ 均有 $\deg(v) \ge 3$。於一F存物N的子集合 $X \subseteq \Sigma$，我用 $T\{X\}$ 泶表 $X$ 中的F存物N在 $T$ 上的演化PS所形成的「演化子洹梗建方式如下：

1. λ有 $X$ 中的任牲c，擞其在 $T$ 上的温剑K⑺有不在 $X$ 且未被擞的ch除以得到 $T'$。
1.  $T'$ 中不h除M足 $\deg(v) = 2$ 的非~c $v$ 以得到 $T\{X\}$：⑴c $v$ BY的l合愠梢l，K移除 $v$。

以下D的演化 $T$ 槔。$T$ e的F存物N集合 $\Sigma = \{1, 2, 3, 4, 5\}$，若取 $X = \{3, 4, 5\}$，t步E $1$ 後得到 $T'$，再^步E $2$ 後得到 $T\{X\}$。注意 $X = \emptyset$ r，根定x我有 $T\{X\} = \emptyset$。

![](https://cdn.luogu.com.cn/upload/image_hosting/c2xg13m0.png)

囊豢醚莼 $T$ 中移除大小 $k \ge 0$ 的任意集合 $K$，可以得到 $k+1$ 棵子 $T^{(1)}, T^{(2)}, \ldots, T^{(k+1)}$，其中每棵子 $T^{(i)}$ 上的物N在 $T$ 中的演化PS都成一棵**演化子**，我Q它 $T$ 中移除 $K$ 所С龅**演化森林**。注意我有

1. $T$ 自身橐瞥 $\emptyset$ 後С龅难莼森林。
1. 若一棵子 $T^{(i)}$ 上]有任何F存物N，的演化子榭铡

以上D中的 $T$ 槔，移除 $K = \{(1, 7), (7, 8), (2, 8), (5, 8)\}$ 四l可以得到五棵子 $T^{(1)}, T^{(2)}, \ldots, T^{(5)}$，接著С鲅莼森林：

![](https://cdn.luogu.com.cn/upload/image_hosting/10jt4cii.png)

比^勺F存物N相同的演化森林r，我只P注F存物Ng的PS，因此已缃^物N（即非~c）的K不重要。O $F_1$ c $F_2$ 勺F存物N相同的演化森林，若移除它的非~c後得完全相同，我就Q $F_1$ c $F_2$ 似。更精_地f，我Q $F_1$ c $F_2$ 似，若且唯若存在某一σ缓 $\Phi: V(F_1) \to V(F_2)$，M足

1. θ我 $u \in \Sigma = \{1, 2, \ldots, n\}$，我有 $\Phi(u) = u$。
1. θ我 $u, v \in V(F_1)$，我有
$$(u, v) \in E(F_1) \iff (\Phi(u), \Phi(v)) \in E(F_2).$$

以下D槔，如果 $T_1, T_2, T_3$ 的非~c都移除，lF $T_1$ c $T_2$ 不似，而 $T_2$ c $T_3$ 似。

![](https://cdn.luogu.com.cn/upload/image_hosting/8vu59rjm.png)

O $T_1$ c $T_2$ 楝F存物N相同的煽醚莼洹Ｈ舸嬖 $T_1$ c $T_2$ 中各h除 $k$ l的方法，使得烧С龅难莼森林似，tQ $T_1$ c $T_2$ 的差不大於 $k$，而M足此l件的最小整 $k^*$ Q $T_1$ c $T_2$ 的**差**。如上D中 $T_2$ c $T_3$ 的差 $0$，而 $T_1$ c $T_2$ 的差 $1$。

![](https://cdn.luogu.com.cn/upload/image_hosting/scjhebou.png)

 $T_1$ c $T_2$ 各h除 $1$ l | С隽祟似的演化森林

O $T_1$ c $T_2$ 中h除的集合分e $K_1$ c $K_2$，煞Nh除方法被椴煌若且唯若 $K_1$ 不同或 $K_2$ 不同。Fo定煽梦锓N集合均 $\Sigma$ 的演化 $T_1, T_2$ 以及一整瞪舷 $k$，彼得想知道它的差 $k^*$ 是否不大於 $k$；如果 $1 \le k^* \le k$，彼得也想知道有多少N $T_1$ 和 $T_2$ 中各h除 $k^*$ l的方法，可以使它С鲱似的演化森林。

## 输入格式
> $n$ $m_1$ $m_2$ $k$   
> $u_1$ $v_1$   
> $u_2$ $v_2$   
> $\vdots$   
> $u_{n+m_1-1}$ $v_{n+m_1-1}$   
> $u_1'$ $v_1'$   
> $u_2'$ $v_2'$   
> $\vdots$   
> $u_{n+m_2-1}'$ $v_{n+m_2-1}'$

* $n$ 代表F存物N集合 $\Sigma = \{1, 2, \ldots, n\}$ 的大小。
* $m_1$ 代表在 $T_1$ 中已缃^物N（以 $n+1, n+2, \ldots, n+m_1$ 表示）的盗俊
* $m_2$ 代表在 $T_2$ 中已缃^物N（以 $n+1, n+2, \ldots, n+m_2$ 表示）的盗俊
* $k$ 代表彼得O定的上限。
* $u_i, v_i$ 代表 $T_1$ 有一l $u_i$ B接到 $v_i$。
* $u_i', v_i'$ 代表 $T_2$ 有一l $u_i'$ B接到 $v_i'$。

## 输出格式
如果 $k^* = 0$，出

> $0$

如果 $1 \le k^* \le k$，出

> $k^*$  
> $S$

其中 $S$ 橐徽担代表 $T_1$ c $T_2$ 中各h除 $k^*$ l後С龅难莼森林似的h除方法怠Ｈ绻 $k^* > k$，出

> $-1$

```input1
5 3 3 2
1 7
2 8
3 6
4 6
5 8
6 7
7 8
1 6
2 8
3 6
4 7
5 8
6 7
7 8
```

```output1
1
4
```

```input2
4 2 2 0
1 5
2 5
3 6
4 6
5 6
1 6
2 6
3 5
4 5
5 6
```

```output2
0
```

```input3
6 3 3 2
1 7
2 7
3 7
4 8
5 9
6 9
7 8
8 9
1 7
2 7
3 9
4 9
5 8
6 8
7 8
8 9
```

```output3
2
9
```

```input4
6 1 4 2
1 7
2 7
3 7
4 7
5 7
6 7
1 7
2 7
3 8
4 8
5 9
6 9
7 10
8 10
9 10
```

```output4
-1
```

## 提示
### yY限制

* $n \ge 2$。
* $0 \le m_1 \le 300-n$。
* $0 \le m_2 \le 300-n$。
* $k \in \{0, 1, 2\}$。
* $1 \le u_i \le n+m_1$。
* $1 \le v_i \le n+m_1$。
* $1 \le u_i' \le n+m_2$。
* $1 \le v_i' \le n+m_2$。
* o定的 $T_1$ c $T_2$ 保CB通，且
  1. 若 $u \in \{1, 2, \ldots, n\}$，t在 $T_1$ c $T_2$ 中 $\deg(u) = 1$。
  1. 若 $u \in \{n+1, n+2, \ldots, n+m_1\}$，t在 $T_1$ 中 $\deg(u) \ge 3$。
  1. 若 $u \in \{n+1, n+2, \ldots, n+m_2\}$，t在 $T_2$ 中 $\deg(u) \ge 3$。
* 入的到檎怠

### u分f明

本}共有四M子任眨l件限制如下所示。
每一M可有一或多PyY料，M所有yY料皆需答Σ@得M分怠

|  子任  |  分  | ~外入限制 |
| :------: | :----: | ------------ |
| 1 | $21$ | $k = 0$ |
| 2 | $13$ | $k \in \{0, 1\}$ |
| 3 | $23$ | $n+m_1 \le 30$ 且 $n+m_2 \le 30$ |
| 4 | $43$ | o~外限制 |

