<p style="text-align: left;">&nbsp;</p>
<div id="cv-problem-text" style="color: #333333; font-family: OpenSans-Light, Calibri, Cambria, sans-serif; font-size: 14px; line-height: 20px; text-align: left;">Digo is given a rooted tree where nodes are numbered from 1 to N (1 is the root node) and asked some queries on it.&nbsp;<br>There are two types of queries<br>1) Given node number U, two integers X, K which means add X to the given node , X+K to its children , X+2*K to children of its children and so on..<br>2) Given a node number U print the sum of nodes in the subtree rooted at U (including node U).<br><br>Since the answer can be too long, print the answer 10^9 + 7<br>Initially each node contains zero.<br><br>Input Format:<br><br>First line contains a single integer N denoting the number of nodes in the tree.<br>Next N-1 lines denotes the parent node of nodes 2 to N. (1 is the root node it has no parent)<br>Next line contains M (Number of queries).<br>In each of the next M lines first integer is T which means the type of the query.<br>If T is ,1 it is followed by three integers U, X, K as explained in the question.<br>If T is 2, it is followed by a single integer U.<br><br>Output Format:-<br><br>For each query of type 2, output a single line containing the required answer.<br><br>Constraints:-&nbsp;<br><br>1 &lt;= N &lt;= 100000<br>1 &lt;= M &lt;= 100000<br>1 &lt;= X , K &lt;=1000000000<br><br>Sample Input:<br><br>7<br>1<br>1<br>2<br>2<br>3<br>3<br>5<br>1 1 1 2<br>2 1<br>2 3<br>1 3 2 1<br>2 3<br><br>Sample Output:<br><br>27<br>13<br>21</div>
<p style="text-align: left;">&nbsp;</p>
<p style="text-align: left;">&nbsp;</p>