## 题目描述
[problemUrl]: https://atcoder.jp/contests/abc286/tasks/abc286_e

$ N $ の都市があり、いくつかの相なる都市のgは一方通行の直行便によって移婴工毪长趣できます。  
 どの直行便が存在するかは $ N $ のLさ $ N $ の文字列 $ S_1,S_2,\ldots,S_N $ によって表され、 $ S_i $ の $ j $ 文字目が `Y` のとき都市 $ i $ から都市 $ j $ へ向かう直行便が存在することを、 `N` のとき存在しないことを示します。  
 また、各都市ではお土bが $ 1 $ つずつ婴椁欷皮り、都市 $ i $ では $ A_i $ のお土bが婴椁欷皮い蓼埂

次のような}を考えます。

> 高蚓は今都市 $ S $ におり、いくつかの直行便を\り@いで($ S $ とはなる)都市 $ T $ に向かおうとしています。  
>  さらに、高蚓は移婴工胪局肖窃Lれた都市($ S,T $ を含む)において $ 1 $ つずつお土bを入します。  
>  都市 $ S $ から都市 $ T $ へ向かうU路が}数存在するr、高蚓は次のようなU路で移婴工毪长趣蚩激à皮い蓼埂
> 
> - 都市 $ S $ から 都市 $ T $ に向かうU路のうち、使う直行便の数が最小である。
> - さらにそのようなU路のうち、入するお土bののt和が最大である。
>  
> 高蚓が都市 $ S $ から $ T $ に直行便を\り@いで移婴工毪长趣可能か判定し、 可能なrは高蚓が上の条件をみたすようにU路をxんだrの「使用する直行便の本数」と「お土bののt和」を求めよ。

相なる都市のM $ (U_i,V_i) $ が $ Q $ 与えられます。  
 各 $ 1\leq\ i\leq\ Q $ について、$ S=U_i,\ T=V_i $ としたrの上の}の答えを出力してください。

## 输入格式
入力は以下の形式で嗜肓Δら与えられる。

> $ N $ $ A_1 $ $ A_2 $ $ \ldots $ $ A_N $ $ S_1 $ $ S_2 $ $ \vdots $ $ S_N $ $ Q $ $ U_1 $ $ V_1 $ $ U_2 $ $ V_2 $ $ \vdots $ $ U_Q $ $ V_Q $

## 输出格式
$ Q $ 行出力せよ。  
 $ i $ $ (1\leq\ i\leq\ Q) $ 行目には、 都市 $ U_i $ から都市 $ V_i $ に移婴工毪长趣不可能なrは `Impossible` を、 可能なrは上のようにU路をxんだrの「使用する直行便の本数」と「お土bののt和」をこのに空白区切りで出力せよ。

## 题目大意
#### 题目描述

从前有 $n$ 座岛，每个岛上有 $a_i$ 个金币，各个岛间有若干条单向航线相连。

你从某个岛开始旅行，经过一个岛（包括最开始所在的岛）就会拿走上面的金币。

现在问你 $q$ 个问题：从岛 $u_i$ 旅行到岛 $v_i$，最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。如果根本无法到达 $v_i$，输出 `Impossible`。

询问之间相互独立。

#### 输入格式

输入第一行一个整数 $n$ 表示岛的数量。

接下来一行 $n$ 个整数表示每个岛上的金币数。

接下来 $n$ 行每行一个长为 $n$ 的字符串，第 $i$ 行字符串的第 $j$ 个字符若为 `Y` 则表示岛 $i$ 和 $j$ 间有单向航线，否则表示没有。

接下来一行一个整数 $q$ 表示询问次数。

最后 $q$ 行每行两个整数 $u_i,v_i$，询问你从岛 $u_i$ 旅行到岛 $v_i$ 最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。

#### 输出格式

对于每个询问输出一行：

- 若 $u_i$ 不能到达 $v_i$，输出 `Impossible`；
- 否则，输出从岛 $u_i$ 旅行到岛 $v_i$ 最少要走几条航线，以及恰好走这么多条航线最多能获得多少金币。

#### 样例解释 1

这些岛的结构如下：

![](https://cdn.luogu.com.cn/upload/image_hosting/61s6gh7q.png)

- 对于第 $1$ 个询问，因为岛 $1$ 有一条航线通往岛 $3$，显然最少航线为 $1$ 条，此时能拿到岛 $1$ 和岛 $3$ 上的金币共 $30+70=100$ 个。
- 对于第 $2$ 个询问，可以证明最少航线为 $2$ 条，有两种方案 $3 \rarr 4 \rarr 1$ 和 $3 \rarr 5 \rarr 1$，总金币分别为 $70+20+30=120$ 和 $70+60+30=160$，故最多金币为 $160$。
- 对于第 $3$ 个询问，只有一种方案 $4 \rarr 1 \rarr 3 \rarr 5$ 可以使航线数最少为 $3$，所得金币为 $20+30+70+60=180$。

#### 样例解释 2

笑死，连航线都没有。

#### 数据范围与约定

对于 $100\%$ 的数据，$2\le n\le 300,1\le a_i\le 10^9,1\le q\le n(n-1),1\le u_i,v_i\le n$，且询问中的 $u_i,v_i$ 各不相同。

翻译者：[not_Rick_Astley](https://www.luogu.com.cn/user/689673)

```input1
5
30 50 70 20 60
NYYNN
NNYNN
NNNYY
YNNNN
YNNNN
3
1 3
3 1
4 5
```

```output1
1 100
2 160
3 180
```

```input2
2
100 100
NN
NN
1
1 2
```

```output2
Impossible
```

## 提示
### 制s

- $ 2\ \leq\ N\ \leq\ 300 $
- $ 1\leq\ A_i\leq\ 10^9 $
- $ S_i $ は `Y` と `N` のみからなるLさ $ N $ の文字列
- $ S_i $ の $ i $ 文字目は `N`
- $ 1\leq\ Q\leq\ N(N-1) $
- $ 1\leq\ U_i,V_i\leq\ N $
- $ U_i\neq\ V_i $
- $ i\neq\ j $ ならば $ (U_i,V_i)\neq\ (U_j,V_J) $
- $ N,A_i,Q,U_i,V_i $ は全て整数
 
### Sample Explanation 1

$ (S,T)=(U_1,V_1)=(1,3) $ のrについて、都市 $ 1 $ から都市 $ 3 $ への直行便が存在するため、 使用する直行便としてあり得る最小のはその直行便を使用したrの $ 1 $ 本となります。 このr、お土bののt和は $ A_1+A_3=30+70=100 $ となります。 $ (S,T)=(U_2,V_2)=(3,1) $ のrについて、使用する直行便としてあり得る最小のは $ 2 $ 本で、 最小を_成するU路としては都市 $ 3\to\ 4\to\ 1 $ と都市 $ 3\to\ 5\to\ 1 $ の $ 2 $ 通りが考えられます。 それぞれのU路のrのお土bののt和は $ 70+20+30=120 $, $ 70+60+30=160 $ なので、 高蚓は後者のU路をxび、このrお土bののt和は $ 160 $ となります。 $ (S,T)=(U_3,V_3)=(4,5) $ のrについて、都市 $ 4\to\ 1\to\ 3\to\ 5 $ とMんだrに使用する直行便の本数は最小となり、 このrお土bののt和は $ 20+30+70+60=180 $ となります。

### Sample Explanation 2

直行便が全く存在しないこともあります。

