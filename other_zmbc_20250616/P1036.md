<h2>Description</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			小 Yuuka 遇到了一个题目：有一个序列 <span class="katex"><span class="katex-mathml">a1,a2,…,ana_1, a_2, \ldots , a_n</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span></span></span></span>，对其进行<span class="katex"><span class="katex-mathml">qq</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">q</span></span></span></span>次操作，每次把一个区间内的数改成区间内的最大值，问最后每个数是多少。
		</p>
		<p>
			小 Yuuka 很快地就使用了线段树解决了这个问题。于是充满智慧的小 Yuuka 想，如果操作是随机的，即在这 <span class="katex"><span class="katex-mathml">qq</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">q</span></span></span></span> 次操作中每次等概率随机地选择一个区间 <span class="katex"><span class="katex-mathml">[l,r][l,r]</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">[</span><span class="mord mathit">l</span><span class="mpunct">,</span><span class="mord mathit">r</span><span class="mclose">]</span></span></span></span> <span class="katex"><span class="katex-mathml">(1≤l≤r≤n)(1 \leq l \leq r \leq n)</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mrel">≤</span><span class="mord mathit">l</span><span class="mrel">≤</span><span class="mord mathit">r</span><span class="mrel">≤</span><span class="mord mathit">n</span><span class="mclose">)</span></span></span></span>，然后将这个区间内的数改成区间内最大值（注意这样的区间共有 <span class="katex"><span class="katex-mathml">n(n+1)2\frac{n(n+1)}{2}</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span> 个），最后每个数的期望大小是多少呢？小 Yuuka 非常热爱随机，所以她给出的输入序列也是随机的（随机方式见数据规模和约定）。对于每个数，输出它的期望乘 <span class="katex"><span class="katex-mathml">(n(n+1)2)q(\frac{n(n+1)}{2})^q</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord scriptstyle cramped"><span class="mord mathrm">2</span></span></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord scriptstyle uncramped"><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit">n</span><span class="mbin">+</span><span class="mord mathrm">1</span><span class="mclose">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mclose"><span class="mclose">)</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathit">q</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span></span></span></span> 再对 <span class="katex"><span class="katex-mathml">109+710^9+7</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">9</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="mbin">+</span><span class="mord mathrm">7</span></span></span></span> 取模的值。
		</p>
	</div>
</div>
<h2>Input Format</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			第一行包含两个正整数 <span class="katex"><span class="katex-mathml">n,qn,q</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mpunct">,</span><span class="mord mathit">q</span></span></span></span>，表示序列里数的个数和操作的个数。
		</p>
		<p>
			接下来一行，包含 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 个非负整数 <span class="katex"><span class="katex-mathml">a1,a2,…,ana_1, a_2, \ldots, a_n</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathrm">2</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span><span class="mpunct">,</span><span class="minner">…</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">a</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle cramped"><span class="mord mathit">n</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span></span></span></span>。
		</p>
	</div>
</div>
<h2>Output Format</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			输出共一行，包含 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 个整数，表示每个数的答案
		</p>
	</div>
</div>
<pre><code class="language-input1">
5 5
1 5 2 3 4
</code></pre><pre><code class="language-output1">
3152671 3796875 3692207 3623487 3515626
</code></pre>
<h2>Hint</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			对于所有的测试数据，保证序列中数的大小不超过 <span class="katex"><span class="katex-mathml">10910^9</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">9</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span></span></span></span>，即 <span class="mjx-chtml"><span class="mjx-math"><span class="mjx-mrow"><span class="mjx-msubsup"><span class="mjx-base"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I">a</span></span></span><span class="mjx-sub" style="font-size:70.7%;vertical-align:-0.212em;"><span class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I">i</span></span></span></span><span class="mjx-mo MJXc-space3"><span class="mjx-char MJXc-TeX-main-R">≤</span></span><span class="mjx-msubsup MJXc-space3"><span class="mjx-base"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R">10</span></span></span><span class="mjx-sup" style="font-size:70.7%;vertical-align:0.591em;"><span class="mjx-mn"><span class="mjx-char MJXc-TeX-main-R">9</span></span></span></span></span></span></span>，并且每个数是 <span class="katex"><span class="katex-mathml">00</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> 到 <span class="katex"><span class="katex-mathml">10910^9</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord"><span class="mord mathrm">0</span><span class="vlist"><span><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span><span class="reset-textstyle scriptstyle uncramped"><span class="mord mathrm">9</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;"></span></span></span></span></span></span></span></span> 之间的随机整数。<span class="katex"><span class="katex-mathml">n≤400,&nbsp;q≤400n \leq 400, \ q \leq 400</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mrel">≤</span><span class="mord mathrm">4</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mspace"> </span><span class="mord mathit">q</span><span class="mrel">≤</span><span class="mord mathrm">4</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>。
		</p>
	</div>
</div>
<h2>Source</h2>
ZJOI2016 NOIP 省选 高级