<h2>Description</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			幽香是全幻想乡里最受人欢迎的萌妹子，这天，是幽香的 2600 岁生日，无数幽香的粉丝到了幽香家门前的太阳花田上来为幽香庆祝生日。
		</p>
		<p>
			粉丝们非常热情，自发组织表演了一系列节目给幽香看。幽香当然也非常高兴啦。
		</p>
		<p>
			这时幽香发现了一件非常有趣的事情，太阳花田有 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 块空地。在过去，幽香为了方便，在这 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 块空地之间修建了 <span class="katex"><span class="katex-mathml">n−1n-1</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span> 条边将它们连通起来。也就是说，这 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 块空地形成了一个树的结构。
		</p>
		<p>
			有 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 个粉丝们来到了太阳花田上。为了表达对幽香生日的祝贺，他们选择了 <span class="katex"><span class="katex-mathml">cc</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span></span></span></span> 种颜色的衣服，每种颜色恰好可以用一个 <span class="katex"><span class="katex-mathml">00</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> 到 <span class="katex"><span class="katex-mathml">c−1c-1</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span> 之间的整数来表示。并且每个人都站在一个空地上，每个空地上也只有一个人。这样整个太阳花田就花花绿绿了。幽香看到了，感觉也非常开心。
		</p>
		<p>
			粉丝们策划的一个节目是这样的，选中两个粉丝 <span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span> 和 <span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span></span></span></span>（<span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span> 和 <span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span></span></span></span> 可以相同），然后 <span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span> 所在的空地到 <span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span></span></span></span> 所在的空地的路径上的粉丝依次跳起来（包括端点），幽香就能看到一个长度为 <span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span> 到 <span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span></span></span></span> 之间路径上的所有粉丝的数目（包括 <span class="katex"><span class="katex-mathml">AA</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span></span></span></span> 和 <span class="katex"><span class="katex-mathml">BB</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span></span></span></span>）的颜色序列。一开始大家打算让人一两个粉丝（注意：<span class="katex"><span class="katex-mathml">A,BA,B</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">A</span><span class="mpunct">,</span><span class="mord mathit">B</span></span></span></span> 和 <span class="katex"><span class="katex-mathml">B,AB,A</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">B</span><span class="mpunct">,</span><span class="mord mathit">A</span></span></span></span> 是不同的，他们形成的序列刚好相反，比如红绿蓝和蓝绿红）都来一次，但是有人指出这样可能会出现一些一模一样的颜色序列，会导致审美疲劳。
		</p>
		<p>
			于是他们想要问题，在这个树上，一共有多少可能的不同的颜色序列（子串）幽香可以看到呢？
		</p>
		<p>
			太阳花田的结构比较特殊，只与一个空地相邻的空地数量不超过 <span class="katex"><span class="katex-mathml">2020</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">2</span><span class="mord mathrm">0</span></span></span></span> 个。
		</p>
	</div>
</div>
<h2>Input Format</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			第一行两个正整数 <span class="katex"><span class="katex-mathml">n,cn,c</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mpunct">,</span><span class="mord mathit">c</span></span></span></span> 。表示空地数量和颜色数量。
		</p>
		<p>
			第二行有 <span class="katex"><span class="katex-mathml">nn</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span></span></span></span> 个 <span class="katex"><span class="katex-mathml">00</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">0</span></span></span></span> 到 <span class="katex"><span class="katex-mathml">c−1c-1</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">c</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span>之间，由空格隔开的整数，依次表示第 <span class="katex"><span class="katex-mathml">ii</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">i</span></span></span></span> 块空地上的粉丝的衣服颜色。（这里我们按照节点标号从小到大的顺序依次给出每块空地上粉丝的衣服颜色）。
		</p>
		<p>
			接下来 <span class="katex"><span class="katex-mathml">n−1n-1</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mbin">−</span><span class="mord mathrm">1</span></span></span></span> 行，每行两个正整数 <span class="katex"><span class="katex-mathml">u,vu,v</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span><span class="mpunct">,</span><span class="mord mathit">v</span></span></span></span>，表示有一条连接空地 <span class="katex"><span class="katex-mathml">uu</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">u</span></span></span></span> 和空地 <span class="katex"><span class="katex-mathml">vv</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">v</span></span></span></span> 的边。
		</p>
	</div>
</div>
<h2>Output Format</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			一行，输出一个整数，表示答案。
		</p>
	</div>
</div>
<pre><code class="language-input1">
7 3
0 2 1 2 1 0 0 
1 2
3 4
3 5
4 6
5 7
2 5
</code></pre><pre><code class="language-output1">
30
</code></pre>
<h2>Hint</h2>
<div class="ui bottom attached segment font-content">
	<div>
		<p>
			对于所有数据，<span class="katex"><span class="katex-mathml">1≤n≤100000,1≤c≤101 \leq n \leq 100000, 1 \leq c \leq 10</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mrel">≤</span><span class="mord mathit">n</span><span class="mrel">≤</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mpunct">,</span><span class="mord mathrm">1</span><span class="mrel">≤</span><span class="mord mathit">c</span><span class="mrel">≤</span><span class="mord mathrm">1</span><span class="mord mathrm">0</span></span></span></span>。
		</p>
		<p>
			对于 <span class="katex"><span class="katex-mathml">15%15 \%</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.05556em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">1</span><span class="mord mathrm">5</span><span class="mord mathrm">%</span></span></span></span> 的数据，<span class="katex"><span class="katex-mathml">n≤2000n \leq 2000</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.13597em;"></span><span class="base textstyle uncramped"><span class="mord mathit">n</span><span class="mrel">≤</span><span class="mord mathrm">2</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span><span class="mord mathrm">0</span></span></span></span>。
		</p>
		<p>
			另有 <span class="katex"><span class="katex-mathml">5%5 \%</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.05556em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">%</span></span></span></span> 的数据，所有空地都至多与两个空地相邻。
		</p>
		<p>
			另有 <span class="katex"><span class="katex-mathml">5%5 \%</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.05556em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">%</span></span></span></span> 的数据，除一块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。
		</p>
		<p>
			另有 <span class="katex"><span class="katex-mathml">5%5 \%</span><span class="katex-html"><span class="strut"></span><span class="strut bottom" style="vertical-align:-0.05556em;"></span><span class="base textstyle uncramped"><span class="mord mathrm">5</span><span class="mord mathrm">%</span></span></span></span> 的数据，除某两块空地与三个空地相邻外，其他空地都分别至多与两个空地相邻。
		</p>
	</div>
</div>
<h2>Source</h2>
ZJOI2015 NOIP 省选 高级