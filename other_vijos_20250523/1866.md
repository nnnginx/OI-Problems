<h1>描述</h1>

<p>近日,?长发现动物园?好吃懒做的动物越来越多了。例如企?,?会卖? 向游客?吃的。为了整治动物园的不?风气,让动物们??己的真才实?向游?? 要吃?,?长决定开设算法班,让动物们学习算法?<br>
某天,?长给动物?讲解 KMP 算法?<br>
??:“?于一?字?串 S,它的长度? L。我??以在 O(L)的时间内,?<br>
出一?名为 next 的数组。有谁?习? next 数组的含义吗?? 熊猫:“?于字?串 S 的前 i ?字?构成的子串,既是它的后缀又是它的?<br>
缀的字符串?(它本?除??),最长的长度记作 next[i]。?<br>
??:“非常好!那你能举?例子???<br>
熊猫:“例 S ? abcababc,? next[5]=2。因? S 的前 5 ?字?为 abcab,ab 既是它的后缀又是它的前缀,并且找不到一?更长的字符串满足这个性质。同?, 还可得出 next[1] = next[2] = next[3] = 0,next[4] = next[6] = 1,next[7] = 2,next[8] = 3 。?<br>
?长表?了?真预习的熊?同?。随?,他?细讲解了?何? O(L)的时? 内求? next 数组?<br>
下?前,?长提出了一???:“KMP 算法?能求出𝑛𝑒𝑥? 数组。我现在希望 求出一?更强? num 数组——?于字?串 𝑆 的前 𝑖 ?字?构成的子串,既是它的 后缀同时又是它的前缀,并且该后缀与?前缀不重?,将这种字符串的数量?作 num[i]。例? S ? aaaaa,? num[4] = 2。这?因为 S 的前 4 ?字?为 aaaa,其中 a ? aa 都满足性质‘既?后缀又是前缀?,同时保证这个后缀与这?前缀不重叠? ? aaa 虽然满足性质‘既?后缀又是前缀?,但遗憾的?这个后缀与这?前缀? 叠了,所以不能?算在内。同?,num[1] = 0,num[2] = num[3] = 1,num[5] = 2。?<br>
最?,?长给出了奖励条件,?一?做?的同??励巧克力一盒。听了这? ?,睡了一节?的企鹅立刻就醒过来?!但企鹅并不会做这道??,于是向参观动 物园的你寻求?助。你能否?助企鹅写一?程序求出 num 数组??<br>
特别?,为了避免大量的输?,你不需要输? num[i]分别?多少,你只需要输? ∏𝐿?=1(𝑛𝑢𝑚[𝑖] + 1) ? 1,000,000,007 取模的结果即??<br>
其中∏𝐿?=1(𝑛𝑢𝑚[𝑖] + 1) = (𝑛𝑢𝑚[1] + 1) × (𝑛𝑢𝑚[2] + 1) × ? × (𝑛𝑢𝑚[𝐿] + 1)?</p>

<h1>格式</h1>

<h2>输入格式</h2>

<p>输入的?? 1 行仅包含一?正整? n ,表示测试数据的组数?<br>
随后 n ?,每?描述一组测试数?。每组测试数?仅含有一?字?串 S,S 的定义???目描述。数?保证 S ?仅含小写字母?<br>
输入?不会包含多余的空?,行末不会存在多余的空格?</p>

<h2>输出格式</h2>

<p>输出应包?𝑛?,每?描述一组测试数?的答?,答?的顺序应与输入 数据的顺序保持一致。?于每组测试数据,仅需要输出一?整数,表示这组测试 数据的答案?? 1,000,000,007 取模的结果?<br>
输出?不应包含多余的空行?</p>

<h1>样例1</h1>

<h2>样例输入1</h2>

<div class="code-toolbar"><pre class="syntax-hl line-numbers language-data" tabindex="0"><code class="language-data">3
aaaaa
ab
abcababc

<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><div class="toolbar"><div class="toolbar-item"><a href="javascript:;">Copy</a></div></div></div>

<h2>样例输出1</h2>

<div class="code-toolbar"><pre class="syntax-hl line-numbers language-data" tabindex="0"><code class="language-data">36 
1 
32

<span aria-hidden="true" class="line-numbers-rows"><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span><span style="height: 21px;"></span></span><span class="line-numbers-sizer" style="display: none;"></span></code></pre><div class="toolbar"><div class="toolbar-item"><a href="javascript:;">Copy</a></div></div></div>

<h1>限制</h1>

<p>𝑛 ? 5, 𝐿 ? 1,000,000</p>

<h1>来源</h1>

<p>NOI 2014 Day 2</p>

        