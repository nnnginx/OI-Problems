23．（完善程序）

对于一个 1 到 n 的排列 P（即 1 到 n 中每一个数在 P 中出现了恰好一次），令 qi 为第 i 个位置之后第一个比 Pi 值更大的位置，如果不存在这样的位置，则 qi = n + 1。

举例来说，如果 n = 5 且 P 为 1 5 4 2 3，则 q 为 2 6 6 5 6。

下列程序读入了排列 P，使用双向链表求解了答案。试补全程序。（第二空 2 分，其余 3 分）

数据范围 1 ≤ n ≤ $10^5$。

```
#include <iostream>
using namespace std;
const int N = 100010;
int n;
int L[N], R[N], a[N];
int main() {
    cin >> n;
    for (int i = 1; i <= n; ++i) {
        int x;
        cin >> x;
        _________________________;
    }
    for (int i = 1; i <= n; ++i) {
        R[i] = _________________________;
        L[i] = i - 1;
    }
    for (int i = 1; i <= n; ++i) {
        L[_________________________] = L[a[i]];
        R[L[a[i]]] = R[_________________________];
    }
    for (int i = 1; i <= n; ++i) {
        cout << _________________________ << " ";
    }
    cout << endl;
    return 0;
}
```

①：{{ input(1) }}

②：{{ input(2) }}

③：{{ input(3) }}

④：{{ input(4) }}

⑤：{{ input(5) }}
