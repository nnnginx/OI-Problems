<h2>Description</h2><span lang="en-us"><p>You are given a strange scale (see the figure below), and you are wondering how to balance this scale. After several attempts, you have discovered the way to balance it ¡ª you need to put different numbers on different squares while satisfying the following two equations:</p><div align="center"><table border="0" width="600"><tbody><tr><td align="center" width="10%"><i>x</i><sub>1</sub> * 4</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>2</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>3</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="4%"><i>x</i><sub>4</sub></td><td align="center" width="4%">=</td><td align="center" width="4%"><i>x</i><sub>5</sub></td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>6</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>7</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>x</i><sub>8</sub> * 4</td></tr><tr><td align="center" width="10%"><i>y</i><sub>1</sub> * 4</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>2</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>3</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="4%"><i>y</i><sub>4</sub></td><td align="center" width="4%">=</td><td align="center" width="4%"><i>y</i><sub>5</sub></td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>6</sub> * 2</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>7</sub> * 3</td><td align="center" width="4%">+</td><td align="center" width="10%"><i>y</i><sub>8</sub> * 4</td></tr></tbody></table></div><p>How many ways can you balance this strange scale with the given numbers?</p></span><img src="images/3139_1.png" align="right" hspace="10" vspace="10"><h2>Input</h2><p>There are multiple test cases in the input file. Each test case consists of 16 distinct numbers in the range [1, 1024] on one separate line. You are allowed to use each number only once.</p><p>A line with one single integer 0 indicates the end of input and should not be processed by your program.</p><h2>Output</h2><p>For each test case, if it is possible to balance the scale in question, output one number, the number of different ways to balance this scale, in the format as indicated in the sample output. Rotations and reversals of the same arrangement should be counted only once.</p><pre><code class="language-input1">87 33 98 83 67 97 44 72 91 78 46 49 64 59 85 88
0</code></pre><pre><code class="language-output1">Case 1: 15227223</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=Shanghai+2006">Shanghai 2006</a>