<h2>Description</h2><span lang="en-us"><p>A <i>cellular automaton</i> is a collection of cells on a grid of specified shape that evolves through a number of discrete time steps according to a set of rules that describe the new state of a cell based on the states of neighboring cells. The <i>order of the cellular automaton</i> is the number of cells it contains. Cells of the automaton of order <i>n</i> are numbered from 1 to <i>n</i>.</p><p>The <i>order of the cell</i> is the number of different values it may contain. Usually, values of a cell of order <i>m</i> are considered to be integer numbers from 0 to <i>m</i> − 1.</p><p>One of the most fundamental properties of a cellular automaton is the type of grid on which it is computed. In this problem we examine the special kind of cellular automaton — circular cellular automaton of order <i>n</i> with cells of order <i>m</i>. We will denote such kind of cellular automaton as <i>n,m-automaton</i>.</p><p>A distance between cells <i>i</i> and <i>j</i> in <i>n</i>,<i>m</i>-automaton is defined as min(|<i>i</i> − <i>j</i>|, <i>n</i> − |<i>i</i> − <i>j</i>|). A <i>d-environment of a cell</i> is the set of cells at a distance not greater than <i>d</i>.</p><p>On each <i>d-step</i> values of all cells are simultaneously replaced by new values. The new value of cell <i>i</i> after <i>d</i>-step is computed as a sum of values of cells belonging to the <i>d</i>-enviroment of the cell <i>i</i> modulo <i>m</i>.</p><p>The following picture shows 1-step of the 5,3-automaton.</p><div align="center"><img src="images/3150_1.gif"></div><p>The problem is to calculate the state of the <i>n</i>,<i>m</i>-automaton after <i>k</i> <i>d</i>-steps.</p></span><h2>Input</h2><span lang="en-us"><p>The first line of the input file contains four integer numbers <i>n</i>, <i>m</i>, <i>d</i>, and <i>k</i> (1 ≤ <i>n</i> ≤ 500, 1 ≤ <i>m</i> ≤ 1 000 000, 0 ≤ <i>d</i> &lt; <sup><i>n</i></sup>⁄<sub>2</sub> , 1 ≤ <i>k</i> ≤ 10 000 000). The second line contains n integer numbers from 0 to <i>m</i> − 1 — initial values of the automaton’s cells.</p></span><h2>Output</h2><span lang="en-us"><p>Output the values of the <i>n</i>,<i>m</i>-automaton’s cells after <i>k</i> <i>d</i>-steps.</p></span><pre><code class="language-input1">&lt;b&gt;sample input #1&lt;/b&gt;
5 3 1 1
1 2 2 1 2

&lt;b&gt;sample input #2&lt;/b&gt;
5 3 1 10
1 2 2 1 2</code></pre><pre><code class="language-output1">&lt;b&gt;sample output #1&lt;/b&gt;
2 2 2 2 1

&lt;b&gt;sample output #2&lt;/b&gt;
2 0 0 2 2</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=Northeastern+Europe+2006">Northeastern Europe 2006</a>