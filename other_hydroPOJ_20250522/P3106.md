<h2>Description</h2><span lang="en-us"><p>Let us define a set of operations on a rectangular matrix of printable characters.</p><p>A matrix <i>A</i> with <i>m</i> rows (1-st index) and <i>n</i> columns (2-nd index) is given. The resulting matrix <i>B</i> is defined as follows.</p><ul><li>Transposition by the main diagonal (operation identifier is ‘<code>1</code>’): <i>B<sub>j</sub></i><sub>,<i>i</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Transposition by the second diagonal (‘<code>2</code>’): <i>B<sub>n</sub></i><sub>−<i>j</i>+1,<i>m</i>−<i>i</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Horizontal flip (‘<code>H</code>’): <i>B</i><sub><i>m</i>−<i>i</i>+1,<i>j</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Vertical flip (‘<code>V</code>’): <i>B<sub>i</sub></i><sub>,<i>n</i>−<i>j</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Rotation by 90 (‘<code>A</code>’), 180 (‘<code>B</code>’), or 270 (‘<code>C</code>’) degrees clockwise; 90 degrees case: <i>B<sub>j</sub></i><sub>,<i>m</i>−<i>i</i>+1</sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li><li>Rotation by 90 (‘<code>X</code>’), 180 (‘<code>Y</code>’), or 270 (‘<code>Z</code>’) degrees counterclockwise; 90 degrees case: <i>B<sub>n</sub></i><sub>−<i>j</i>+1,<i>i</i></sub> = <i>A<sub>i</sub></i><sub>,<i>j</i></sub></li></ul><p>You are given a sequence of no more than 100 000 operations from the set. Apply the operations to the given matrix and output the resulting matrix.</p></span><h2>Input</h2><span lang="en-us"><p>At the first line of the input file there are two integer numbers — <i>m</i> and <i>n</i> (0 &lt; <i>m</i>, <i>n</i> ≤ 300). Then there are <i>m</i> lines with <i>n</i> printable characters per line (we define a printable character as a symbol with ASCII code from 33 to 126 inclusive). There will be no additional symbols at these lines.</p><p>The next line contains the sequence operations to be performed, specified by their one-character identifiers. The operations should be performed from left to right.</p></span><h2>Output</h2><p>Two integer numbers, the number of rows and columns in the output matrix. Then the output matrix must follow, in the same format as the input one.</p><pre><code class="language-input1">3 4
0000
a0b0
cdef
A1</code></pre><pre><code class="language-output1">3 4
cdef
a0b0
0000</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=Northeastern+Europe+2005">Northeastern Europe 2005</a><p>, Northern Subregion</p>