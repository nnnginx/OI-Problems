<h2>Description</h2><p>The ¡°Hanoi Towers¡± puzzle consists of three pegs (that we will name <i>A</i>, <i>B</i>, and <i>C</i>) with <i>n</i> disks of different diameters stacked onto the pegs. Initially all disks are stacked onto peg <i>A</i> with the smallest disk at the top and the largest one at the bottom, so that they form a conical shape on peg <i>A</i>.</p><div align="center"><img src="images/3572_1.png"></div><p>A valid move in the puzzle is moving one disk from the top of one (source) peg to the top of the other (destination) peg, with a constraint that a disk can be placed only onto an empty destination peg or onto a disk of a larger diameter. We denote a move with two capital letters ¡ª the first letter denotes the source disk, and the second letter denotes the destination disk. For example, <tt>AB</tt> is a move from disk <i>A</i> to disk <i>B</i>.</p><p>The puzzle is considered solved when all the disks are stacked onto either peg <i>B</i> (with pegs <i>A</i> and <i>C</i> empty) or onto peg <i>C</i> (with pegs <i>A</i> and <i>B</i> empty). We will solve this puzzle with the following algorithm.</p><p>All six potential moves in the game (<tt>AB</tt>, <tt>AC</tt>, <tt>BA</tt>, <tt>BC</tt>, <tt>CA</tt>, and <tt>CB</tt>) are arranged into a list. The order of moves in this list defines our strategy. We always make the first valid move from this list with an additional constraint that we never move the same disk twice in a row.</p><p>It can be proven that this algorithm always solves the puzzle. Your problem is to find the number of moves it takes for this algorithm to solve the puzzle using a given strategy.</p><h2>Input</h2><p>The input file contains two lines. The first line consists of a single integer number <i>n</i> (1 ¡Ü <i>n</i> ¡Ü 30) ¡ª the number of disks in the puzzle. The second line contains descriptions of six moves separated by spaces ¡ª the strategy that is used to solve the puzzle.</p><h2>Output</h2><p>Write to the output file the number of moves it takes to solve the puzzle. This number will not exceed 10<sup>18</sup>.</p><pre><code class="language-input1">&lt;table style=&quot;border-color: black; border-collapse: collapse;&quot; border=&quot;1&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;#1&lt;/th&gt;&lt;td&gt;3&lt;br&gt;AB BC CA BA CB AC&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;#2&lt;/th&gt;&lt;td&gt;2&lt;br&gt;AB BA CA BC CB AC&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</code></pre><pre><code class="language-output1">&lt;table style=&quot;border-color: black; border-collapse: collapse;&quot; border=&quot;1&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;th&gt;#1&lt;/th&gt;&lt;td&gt;7&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th&gt;#2&lt;/th&gt;&lt;td&gt;5&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=Northeastern+Europe+2007">Northeastern Europe 2007</a>