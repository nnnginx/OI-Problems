<h2>Description</h2><p>Alex is a system administrator of <i>Domestic Networks Inc.</i> His network connects apartments and spans over multiple buildings.</p><p>The network expands and Alex has to design a new network segment. He has a map that shows apartments to connect and possible links. Each link connects two apartments and for each possible link its length is known. The goal is to make all apartments connected (possibly through other apartments).</p><p><i>Domestic Networks Inc.</i> buys cable in the nearest cable shop. Unfortunately, shop sells only category 5 and 6 cables at price of <i>p</i><sub>5</sub> and <i>p</i><sub>6</sub> rubles per meter respectively. Moreover, there are only <i>q</i><sub>5</sub> meters of category 5 cable and <i>q</i><sub>6</sub> meters of category 6 cable available in the shop.</p><p>Help Alex to solve a hard problem: make a new network construction plan with possible minimal cost. A plan consists of list of links to be made and cable category for each link (each link should be a single piece of cable of either 5 or 6 category). The cost of the plan is the sum of cost of all cables. The total length of cables of each category used in the plan should not exceed the quantity of the cable available in the shop.</p><h2>Input</h2><p>The first line of the input file contains two numbers: <i>n</i> ¡ª the number of apartments to be connected and <i>m</i> ¡ª the number of possible links (1 ¡Ü <i>n</i> ¡Ü 1000, 1 ¡Ü <i>m</i> ¡Ü <nobr>10 000</nobr>).</p><p>Following <i>m</i> lines contain possible link descriptions. Each description consists of three integer numbers: <i>a<sub>i</sub></i> and <i>b<sub>i</sub></i> ¡ª apartments that can be connected by the link and <i>l<sub>i</sub></i> ¡ª link length in meters (0 ¡Ü <i>l<sub>i</sub></i> ¡Ü 100). Apartments are numbered from 1 to <i>n</i>.</p><p>The last line of the input file contains four integer numbers: <i>p</i><sub>5</sub>, <i>q</i><sub>5</sub>, <i>p</i><sub>6</sub> and <i>q</i><sub>6</sub> ¡ª price and quantity of category 5 and 6 cables respectively (1 ¡Ü <i>p<sub>i</sub></i>, <i>q<sub>i</sub></i> ¡Ü <nobr>10 000</nobr>).</p><h2>Output</h2><p>If all apartments can be connected with the available cable, output <i>n</i> lines ¡ª an optimal network construction plan. The first line of the plan must contain plan¡¯s cost. Other lines of the plan must consist of two integer numbers each: <i>a<sub>i</sub></i> ¡ª number of the link to make and <i>c<sub>i</sub></i> ¡ª the category of the cable to make it of. Links are numbered from 1 to <i>m</i> in the order they are specified in the input file. If there are more than one optimal plans, output any of them.</p><p>If there is no plan meeting all requirements, output a single word ¡°<tt>Impossible</tt>¡±.</p><pre><code class="language-input1">6 7
1 2 7
2 6 5
1 4 8
2 3 5
3 4 5
5 6 6
3 5 3
2 11 3 100</code></pre><pre><code class="language-output1">65
1 5
2 6
4 6
5 6
7 5</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=Northeastern+Europe+2007">Northeastern Europe 2007</a><p>, Northern Subregion</p>