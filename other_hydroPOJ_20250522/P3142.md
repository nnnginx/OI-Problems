<h2>Description</h2><span lang="en-us"><blockquote><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Without turning his head, Vader snarled through his mask, “The Millennium Falcon?”</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Piett paused a moment before replying. He would have preferred to avoid that issue. “Our tracking scanners are on it now,” he responded a bit fearfully.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>Vader turned to face the admiral, his towering figure looming over the frightened officer. Piett felt a chill course through his veins, and when the Dark Lord spoke again his voice conveyed an image of the dreadful fate that would be inflicted if his commands were not executed.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>“I want that ship,” he hissed.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>The ice planet was rapidly shrinking to a point of dim light as the Millennium Falcon sped into space. Soon that planet seemed nothing more than one of the billions of light specks scattered throughout the black void.</i></p><p style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>But the Falcon was not alone in its escape into deep space. Rather, it was followed by an Imperial fleet that included the Avenger Star Destroyer and a half-dozen TIE fighter. The fighters moved ahead of the huge, slower-moving Destroyer, and closed in on the fleeing Millennium Falcon.</i></p><p align="right" style="text-indent: 4ex; margin-top: 0; margin-bottom: 0"><i>— Star Wars, Episode V, the Empire Strikes Back</i></p></blockquote><p>You are driving Millennium Falcon, the fastest starship of the entire galaxy, to escape Imperial pursuit. There are <i>N</i> planet systems, numbered from 0 to <i>N</i> − 1, and some of them are connected by one-way hyperspace tunnels. Some hyperspace tunnels are passable at all times, while others are only available at certain times. Initially you are at the ice planet <i>Hoth</i>, the system numbered 0, at time 0 and you need to get to <i>Sullust</i>, the system numbered <i>N</i> − 1. Since there are <i>K</i> Imperial Star Destroyers following you, and they will also make the jump into the hyperspace to continue the pursuit, you have decided to use the <i>K</i> + 1<sup>th</sup> shortest path from <i>Hoth</i> to <i>Sullust</i> so as to minimize the possibility of being attacked halfway by Imperial starships; furthermore, in order to avoid detection, you do not want to risk staying at a system longer than <i>T</i> seconds.</p><p>Note that multiple shortest paths may require same travel time, and your travel path may not be simple (i.e. you are allowed to visit some systems and use some hyperspace tunnels more than once during your journey).</p></span><h2>Input</h2><span lang="en-us"><p>There are multiple test cases in the input file. Each test case starts with four integers <i>N</i>, <i>M</i>, <i>K</i> and <i>T</i>, (1 ≤ <i>N</i> ≤ 100, 0 ≤ <i>M</i> ≤ 500, 0 ≤ <i>K</i> ≤ 9, 0 ≤ <i>T</i> ≤ 100), the number of planet systems, the number of hyperspace tunnels between them, the pursuing Imperial Star Destroyers, and the maximal allowed time to stay at the same system, respectively. <i>M</i> lines follow, each line describes one of the hyperspace tunnels: four integers <i>U</i>, <i>V</i>, <i>C</i>, and <i>W</i>, (0 ≤ <i>U</i>, <i>V</i> ≤ <i>N</i> − 1, 1 ≤ <i>C</i> ≤ 10, 1 ≤ <i>W</i> ≤ 1000000) meaning there’s a tunnel from <i>U</i> to <i>V</i> , traveling through this path requires <i>W</i> seconds and it is only available every <i>C</i> seconds, starting from time 0 (i.e. 0, <i>C</i>, 2 * <i>C</i>, 3 * <i>C</i> … seconds).</p><p>Two successive inputs are separated by a blank line. <i>N</i> = 0, <i>M</i> = 0, <i>K</i> = 0, <i>T</i> = 0 indicates the end of input and should not be processed by your program.</p></span><h2>Output</h2><p>For every test case, you should output one integer on a separate line, the total time we need to reach <i>Sullust</i> in the format as indicated in the sample output; output <code>-1</code> if no such path can be found.</p><pre><code class="language-input1">5 9 2 2
1 2 5 5
2 4 6 6
0 2 1 8
1 4 4 3
3 0 1 8
1 3 5 10
0 4 4 4
2 3 3 4
3 1 5 10

10 0 0 0

0 0 0 0</code></pre><pre><code class="language-output1">Case 1: 28
Case 2: -1</code></pre><h2>Hint</h2><span lang="en-us"><p>The 1<sup>st</sup> shortest path in this example is 0 → 4, with a total travel time of 4 seconds; the 2<sup>nd</sup> shortest path is 0 (Wait 2 seconds) → 2 (Wait 2 seconds) → 4, with a total travel time of 18 seconds; the 3<sup>rd</sup> shortest path is 0 (Wait 2 seconds) → 2 (Wait 2 seconds) → 3 → 0 → 4, with a total travel time of 28 seconds.</p></span><h2>Source</h2><a href="searchproblem?field=source&amp;key=Shanghai+2006">Shanghai 2006</a>