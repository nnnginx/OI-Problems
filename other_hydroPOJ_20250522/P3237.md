<h2>Description</h2><p>You are given a tree with <i>N</i> nodes. The tree’s nodes are numbered 1 through <i>N</i> and its edges are numbered 1 through <i>N</i> − 1. Each edge is associated with a weight. Then you are to execute a series of instructions on the tree. The instructions can be one of the following forms:</p><table border="1" style="border-collapse: collapse"><tbody><tr><td><code>CHANGE</code> <i>i</i> <i>v</i></td><td>Change the weight of the <i>i</i>th edge to <i>v</i></td></tr><tr><td><code>NEGATE</code> <i>a</i> <i>b</i></td><td>Negate the weight of every edge on the path from <i>a</i> to <i>b</i></td></tr><tr><td><code>QUERY</code> <i>a</i> <i>b</i></td><td>Find the maximum weight of edges on the path from <i>a</i> to <i>b</i></td></tr></tbody></table><h2>Input</h2><span lang="en-us"><p>The input contains multiple test cases. The first line of input contains an integer <i>t</i> (<i>t</i> ≤ 20), the number of test cases. Then follow the test cases.</p><p>Each test case is preceded by an empty line. The first nonempty line of its contains <i>N</i> (<i>N</i> ≤ 10,000). The next <i>N</i> − 1 lines each contains three integers <i>a</i>, <i>b</i> and c, describing an edge connecting nodes <i>a</i> and <i>b</i> with weight <i>c</i>. The edges are numbered in the order they appear in the input. Below them are the instructions, each sticking to the specification above. A lines with the word “<code>DONE</code>” ends the test case.</p></span><h2>Output</h2><span lang="en-us"><p>For each “<code>QUERY</code>” instruction, output the result on a separate line.</p></span><pre><code class="language-input1">1

3
1 2 1
2 3 2
QUERY 1 2
CHANGE 1 3
QUERY 1 2
DONE</code></pre><pre><code class="language-output1">1
3</code></pre><h2>Source</h2><a href="searchproblem?field=source&amp;key=POJ+Monthly--2007.06.03">POJ Monthly--2007.06.03</a><p>, Lei, Tao</p>