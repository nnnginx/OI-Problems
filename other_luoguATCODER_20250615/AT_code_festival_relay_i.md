# AT_code_festival_relay_i 信号待ち

## 题目描述

amylase 去了某个城市。该城市有 $n$ 个十字路口。所有十字路口之间有 $m$ 条道路。

每个十字路口都有一个信号灯，每个红绿灯不是红灯就是绿灯。时间 $t=0,1,2 \dots$ 时第 $i$ 个红绿灯与 $a_i,b_i,c_i$ 的关系如下：

$t=0 \sim c_i-1$ 时是红灯，然后是 $a_i$ 秒绿灯和 $b_i$ 秒红灯（注意：由绿灯变为红色的时刻为红灯，从红到绿的时刻为绿灯）。

各十字路口无论红灯绿灯都可以到达，但是只有绿灯时才能出发。此外，除了信号灯的等待时间外，amylase 可以**在 $0$ 秒内通过任何一个十字路口**。

当 amylase 在 $t=0$ 在十字路口 $s$ 时，求他到十字路口 $d$ 所需的最小时间。

## 输入格式

第 $1$ 行四个整数 $n,m,s,d$。保证 **$m\leqslant \frac{n(n-1)}{2}$** 且 $s \neq d$。随后的 $n$ 行每行三个整数 $a_i,b_i,c_i$。随后的 $m$ 行每行三个整数 $x_i,y_i$ 和 $t_i$ 表示第 $i$ 条道路在十字路口 $x_i$ 和 $y_i$ 之间，amylase 通过这条路需要 $t_i$ 秒。

## 输出格式

一个整数，表示 amylase 从十字路口 $s$ 到十字路口 $d$ 的最短时间。

## 输入输出样例 #1

### 输入 #1

```
2 1 1 2
3 3 4
9 9 9
1 2 4
```

### 输出 #1

```
8
```

## 输入输出样例 #2

### 输入 #2

```
4 4 4 2
2 4 8
9 9 9
2 8 4
3 3 3
1 2 8
1 4 6
2 3 6
3 4 3
```

### 输出 #2

```
17
```

## 说明/提示

对于 $100\%$ 的数据，$2 \le n \le 10^5,1 \le m \le \min(\dfrac{n(n-1)}{2},10^5),1 \le s,d,x_i,y_i \le n,1 \le a_i,b_i,c_i,t_i \le 10^9(1 \le i \le n)$。