## 题目描述

让李旭琳大跌眼镜的是，小墨老师对学习魔法知识并不是很上心，他天天沉迷于各种游戏之中，例如，他现在又和同学们玩起了$\red{Black}$ $\red{Vienna}$游戏，该游戏的规则是这样的：有$\red{18}$张牌，分别标着$\red{A\sim R}$，游戏有三个人。游戏开始的时候每个人拿$\red{5}$张牌，剩下三张牌隐藏起来，大家都只能看见自己手中的牌。之后，从第一个人到第三个人轮流拿一张“审问牌”去问另外的一个人，“审问牌”上有三个字母，那个人必须诚实地回答自己手中有多少“审问牌”中的字母。哪个人能够最先推断出隐藏起来的牌是什么，那个人就取得胜利。现在你的任务是，给出三个人手上的牌和询问情况，你需要计算出最早在哪一次询问之后，有人能够推断出隐藏的牌。　

例如三个玩家的初始状态为：

玩家$\red 1$: $\red{DGJLP}$; 玩家$\red 2$: $\red{EFOQR}$; 玩家$\red 3$: $\red{ACHMN}$; 隐藏牌: $\red{BIK}$

第$\red 1$回合:玩家$\red １$审问玩家$\red ２$有无$\red{BJK}$; 回答为$\red 0$

第$\red 2$回合:玩家$\red 2$审问玩家$\red ３$有无$\red{ABK}$; 回答为$\red 1$

第$\red ３$回合:玩家$\red ３$审问玩家$\red ２$有无$\red{DEF}$;回答为$\red 2$

第$\red 4$回合:玩家$\red 1$审问玩家$\red 2$有无$\red{EIL}$; 回答为$\red 1$

第$\red 5$回合:玩家$\red 2$审问玩家$\red 3$有无$\red{FIP}$; 回答为$\red 0$

第$\red 6$回合:玩家$\red 3$审问玩家$\red １$有无$\red{GMO}$; 回答为$\red 1$

第$\red 7$回合:玩家$\red 1$审问玩家$\red ２$有无$\red{OQR}$;回答为$\red 3$

第$\red 8$回合:玩家$\red 2$ 审问玩家$\red ３$有无$\red{ADQ}$; 回答为$\red 1$

第$\red 9$回合:玩家$\red 3$审问玩家$\red 1$有无$\red{EGJ}$;回答为$\red 2$

事实上，玩家$\red １$能在第$\red ８$回合判断出隐藏牌是$\red{BIK}$。

## 输入格式

输入最多有$\red{12}$组测试数据，所有测试数据结束以$\red{０}$表示。每组测试数据第一行为一整数$\red{t}$，表示审问次数。且$\red{2 ≤ t ≤ 15}$。

下一行包含四个以空格分隔的字符串，表示三个玩家的牌和隐藏牌。

接下来的$\red{t}$行数据为每回合的数据，即审问者和被审问者，审问字母的字符串及被审问者提供的答案。

所有的字符串为从$\red{A}$到$\red{R}$的唯一字母，按严格递增的顺序排列。同样的查询字符串可能出现在多个回合的游戏。

## 输出格式

输出最早第几回合，即有玩家判断出隐藏牌。若无玩家能判断出，则输出字符串$\red{“?”}$。

## 样例

#### 输入样例

```c
9

DGJLP EFOQR ACHMN BIK

2 BJK 0

3 ABK 1

2 DEF 2

2 EIL 1

3 FIP 0

1 GMO 1

2 OQR 3

3 ADQ 1

1 EGJ 2

3

ABCDE FGHIJ KLMNO PQR

3 BKQ 1

1 ADE 3

2 CHJ 2

0
```

#### 输出样例

```c
8

?
```

