## 题目描述

本题中合法括号串的定义如下：

- $\red 1$. `()` 是合法括号串；
- $\red 2$. 如果 `A` 是合法括号串，则 `(A)` 是合法括号串。
- $\red 3$. 如果 `A`，`B` 是合法括号串，则 `AB` 是合法括号串。

本题中子串与不同的子串的定义如下：

- $\red 1$. 字符串 $\red{S}$ 的子串是 $\red{S}$ 中连续的任意个字符组成的字符串。$\red{S}$ 的子串可用起始位置 $\red{l}$ 与终止位置 $\red{r}$ 来表示，记为 $\red{S (l, r)}$（$1 \le l \le r \le |S|$，$\red{|S|}$ 表示 $\red{S}$ 的长度）。
- $\red 2$. $\red{S}$ 的两个子串视作不同当且仅当它们在 $\red{S}$ 中的位置不同，即 $\red{l}$ 不同或 $\red{r}$ 不同。

一个大小为 $\red{n}$ 的树包含 $\red{n}$ 个结点和 $\red{n - 1}$ 条边，每条边连接两个结点，且任意两个结点间有且仅有一条简单路径互相可达。

小 $\red Q$ 是一个充满好奇心的小朋友，有一天他在上学的路上碰见了一个大小为 $\red{n}$ 的树，树上结点从 $\red{1 \sim n}$ 编号，$\red{1}$ 号结点为树的根。除 $\red{1}$ 号结点外，每个结点有一个父亲结点，$\red{u（2 \le u \le n）}$号结点的父亲为 $\red{f_u（1 \le f_u < u）}$号结点。

小 $\red Q$ 发现这个树的每个结点上恰有一个括号，可能是 `(` 或 `)`。小 $\red Q$ 定义 $\red{s_i}$ 为：将根结点到 $\red{i}$ 号结点的简单路径上的括号，按结点经过顺序依次排列组成的字符串。

显然 $\red{s_i}$ 是个括号串，但不一定是合法括号串，因此现在小 $\red Q$ 想对所有的 $\red{i（1 \le i \le n）}$求出，$\red{s_i}$ 中有多少个互不相同的子串是合法括号串。

这个问题难倒了小 $\red Q$，他只好向你求助。设 $\red{s_i}$ 共有 $\red{k_i}$ 个不同子串是合法括号串，你只需要告诉小 $\red Q$ 所有 $\red{i \times k_i}$ 的异或和，即：

$\red{(1\times k_1)\ \text{xor}\ (2\times k_2)\ \text{xor}\ (3\times k_3)\ \text{xor}\ \cdots \ \text{xor}\ (n\times k_n)}$

其中 $\red{\text{xor}}$ 是位异或运算。

## 输入格式

第一行一个整数 $\red{n}$，表示树的大小。

第二行一个长为 $\red{n}$ 的由 `(` 与 `)` 组成的括号串，第 $\red{i}$ 个括号表示 $\red{i}$ 号结点上的括号。

第三行包含 $\red{n−1}$ 个整数，第 $\red{i（1 \le i < n）}$个整数表示 $\red{i + 1}$ 号结点的父亲编号 $\red{f_{i+1}}$。

## 输出格式

仅一行一个整数表示答案。

## 样例

#### 输入样例

```c
5
(()()
1 1 2 2
```

#### 输出样例

```c
6
```

#### 样例说明

树的形态如下图：

![img](./790/file/3.gif)

将根到 $\red{1}$ 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `(`，子串是合法括号串的个数为 $\red{0}$。

将根到 $\red{2}$ 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `((`，子串是合法括号串的个数为 $\red{0}$。

将根到 $\red{3}$ 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `()`，子串是合法括号串的个数为 $\red{1}$。

将根到 $\red{4}$ 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `(((`，子串是合法括号串的个数为 $\red{0}$。

将根到 $\red{5}$ 号结点的简单路径上的括号，按经过顺序排列所组成的字符串为 `(()`，子串是合法括号串的个数为 $\red{1}$。

## 提示

| 测试点编号  |    $\red{n\le }$     | 特殊性质  |
| :---------: | :------------: | :-------: |
|  $\red{1\sim 2}$  |      $\red{8}$       | $\red{f_i=i-1}$ |
|  $\red{3\sim 4}$  |     $\red{200}$      | $\red{f_i=i-1}$ |
|  $\red{5\sim 7}$  | $\red{2\times 10^3}$ | $\red{f_i=i-1}$ |
| $\red{8\sim 10}$  | $\red{2\times 10^3}$ |    无     |
| $\red{11\sim 14}$ |     $\red{10^5}$     | $\red{f_i=i-1}$ |
| $\red{15\sim 16}$ |     $\red{10^5}$     |    无     |
| $\red{17\sim 20}$ | $\red{5\times 10^5}$ |    无     |

