<p>函数是各种编程语言中一项重要的概念，借助函数，我们总可以将复杂的任务分解成一个个相对简单的子任务，直到细化为十分简单的基础操作，从而使代码的组织更加严密、更加有条理。然而，过多的函数调用也会导致额外的开销，影响程序的运行效率。</p>
<p>某数据库应用程序提供了若干函数用以维护数据。已知这些函数的功能可分为三类：</p>
<ol>
<li>将数据中的指定元素加上一个值； </li>
<li>将数据中的每一个元素乘以一个相同值； </li>
<li><strong>依次</strong>执行若干次函数调用，保证不会出现递归（即不会直接或间接地调用本身）。</li>
</ol>
<p>在使用该数据库应用时，用户可一次性输入要调用的函数序列（一个函数可能被调用多次），在<strong>依次</strong>执行完序列中的函数后，系统中的数据被加以更新。 某一天，小 A 在应用该数据库程序处理数据时遇到了困难：由于频繁而低效的函数调用，系统在执行操作时进入了无响应的状态，他只好强制结束了数据库程序。为了计算出正确数据，小 A 查阅了软件的文档，了解到每个函数的具体功能信息，现在他想请你根据这些信息帮他计算出更新后的数据应该是多少。</p>
<h2>输入格式</h2>
<p>第一行一个正整数 $n$，表示数据的个数。 </p>
<p>第二行 $n$ 个整数，第 $i$ 个整数表示下标为 $i$ 的数据的初始值为 $a_i$。 </p>
<p>第三行一个正整数 $m$，表示数据库应用程序提供的函数个数。函数从 $1\ldots m$ 编号。 </p>
<p>接下来 $m$ 行中，第 $j$（$1 \le j \le m$）行的第一个整数为 $T_j$，表示 $j$ 号函数的类型：
1. 若 $T_j = 1$，接下来两个整数 $P_j,~V_j$ 分别表示要执行加法的元素的下标及其增加的值；
1. 若 $T_j = 2$，接下来一个整数 $V_j$ 表示所有元素所乘的值； 
1. 若 $T_j = 3$，接下来一个正整数 $C_j$ 表示 $j$ 号函数要调用的函数个数，随后 $C_j$ 个整数 $g_1^{(j)},~g_2^{(j)},~\ldots,~g_{C_j}^{(j)}$，依次表示其所调用的函数的编号。</p>
<p>第 $m + 4$ 行一个正整数 $Q$，表示输入的函数操作序列长度。</p>
<p>第 $m + 5$ 行 $Q$ 个整数 $f_i$，第 $i$ 个整数表示第 $i$ 个执行的函数的编号。</p>
<h2>输出格式</h2>
<p>一行 $n$ 个用空格隔开的整数，按照下标 $1\ldots n$ 的顺序，分别输出在执行完输入的函数序列后，数据库中每一个元素的值。<strong>答案对</strong> $\boldsymbol{998244353}$ <strong>取模。</strong></p>


<pre><code class="language-input1">3
1 2 3
3
1 1 1
2 2
3 2 1 2
2
2 3
</code></pre>


<pre><code class="language-output1">6 8 12
</code></pre>



<pre><code class="language-input2">10
1 2 3 4 5 6 7 8 9 10
8
3 2 2 3
3 2 4 5
3 2 5 8
2 2
3 2 6 7
1 2 5
1 7 6
2 3
3
1 2 3
</code></pre>


<pre><code class="language-output2">36 282 108 144 180 216 504 288 324 360
</code></pre>

<h2>样例三</h2>
<p>详见附加文件 <code>ex_call3.in/ans</code>。</p>
<h2>限制与约定</h2>
<div class="table-responsive">
<table class="table table-bordered table-text-center table-vertical-middle">
<thead>
<tr>
<th style="text-align:center;">测试点编号</th>
<th style="text-align:center;">$n,m,Q\le$</th>
<th style="text-align:center;">$\sum C_j$</th>
<th style="text-align:center;">其他特殊限制</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">$1\sim 2$</td>
<td style="text-align:center;">$1000$</td>
<td style="text-align:center;">$=m-1$</td>
<td style="text-align:center;">函数调用关系构成一颗树</td>
</tr>
<tr>
<td style="text-align:center;">$3\sim 4$</td>
<td style="text-align:center;">$1000$</td>
<td style="text-align:center;">$\le 100$</td>
<td style="text-align:center;">$ $</td>
</tr>
<tr>
<td style="text-align:center;">$5\sim 6$</td>
<td style="text-align:center;">$20000$</td>
<td style="text-align:center;">$\le 40000$</td>
<td style="text-align:center;">不含第 $2$ 类函数或不含第 $1$ 类函数</td>
</tr>
<tr>
<td style="text-align:center;">$7$</td>
<td style="text-align:center;">$20000$</td>
<td style="text-align:center;">$=0$</td>
<td style="text-align:center;">$ $</td>
</tr>
<tr>
<td style="text-align:center;">$8\sim 9$</td>
<td style="text-align:center;">$20000$</td>
<td style="text-align:center;">$=m-1$</td>
<td style="text-align:center;">函数调用关系构成一颗树</td>
</tr>
<tr>
<td style="text-align:center;">$10\sim 11$</td>
<td style="text-align:center;">$20000$</td>
<td style="text-align:center;">$\le 2\times 10^5$</td>
<td style="text-align:center;">$ $</td>
</tr>
<tr>
<td style="text-align:center;">$12\sim 13$</td>
<td style="text-align:center;">$10^5$</td>
<td style="text-align:center;">$\le 2\times 10^5$</td>
<td style="text-align:center;">不含第 $2$ 类函数或不含第 $1$ 类函数</td>
</tr>
<tr>
<td style="text-align:center;">$14$</td>
<td style="text-align:center;">$10^5$</td>
<td style="text-align:center;">$=0$</td>
<td style="text-align:center;">$ $</td>
</tr>
<tr>
<td style="text-align:center;">$15\sim 16$</td>
<td style="text-align:center;">$10^5$</td>
<td style="text-align:center;">$=m-1$</td>
<td style="text-align:center;">函数调用关系构成一颗树</td>
</tr>
<tr>
<td style="text-align:center;">$17\sim 18$</td>
<td style="text-align:center;">$10^5$</td>
<td style="text-align:center;">$\le 5\times 10^5$</td>
<td style="text-align:center;">$ $</td>
</tr>
<tr>
<td style="text-align:center;">$19\sim 20$</td>
<td style="text-align:center;">$10^5$</td>
<td style="text-align:center;">$\le 10^6$</td>
<td style="text-align:center;">$ $</td>
</tr>
</tbody>
</table>
</div>


<p>对于所有数据：$0 \leq a_i \leq 10^4$，$T_j\in\{1,2,3\}$，$1 \leq P_j \leq n$，$0 \leq V_j \leq 10^4$，$1 \leq g_k^{(j)} \leq m$，$1 \leq f_i \leq m$。</p>
<p><strong>时间限制</strong>：$2 \texttt{s}$</p>
<p><strong>空间限制</strong>：$256 \texttt{MB}$</p>
<h2>下载</h2>
<p><a href="./558/file/attachment.zip">样例数据下载</a></p>
