```input1
8 6
GBRBRRRG
2 1 4
1 2
4 4 5 6 7
3 5 6 7
1 8
1 8

```

```output1
8

```

```input2
4 3
RGBR
2 1 2
2 2 3
2 3 4

```

```output2
impossible

```

```input3
4 4
GBRG
2 1 2
2 2 3
2 3 4
1 4

```

```output3
6

```

```input4
3 3
RGB
1 1
1 2
1 3

```

```output4
3

```

