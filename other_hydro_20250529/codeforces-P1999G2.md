## Description

<div><p><span class="tex-font-style-it">This is the hard version of the problem. The only difference between the two versions is that in this version, you can make at most</span> $\mathbf{7}$ <span class="tex-font-style-it">queries</span>.</p><p><span class="tex-font-style-it">This is an interactive problem. If you are unsure how interactive problems work, then it is recommended to read <a href="https://codeforces.com/blog/entry/45307">the guide for participants</a>.</span></p><p>We have a secret ruler that is missing one number $x$ ($2 \leq x \leq 999$). When you measure an object of length $y$, the ruler reports the following values: </p><ul> <li> If $y &lt; x$, the ruler (correctly) measures the object as having length $y$. </li><li> If $y \geq x$, the ruler incorrectly measures the object as having length $y+1$. </li></ul><center> <img class="tex-graphics" src="./34853/file/EeYpf6nV.png" style="max-width: 100.0%;max-height: 100.0%;"><p><span class="tex-font-size-small">The ruler above is missing the number $4$, so it correctly measures the first segment as length $3$ but incorrectly measures the second segment as length $6$ even though it is actually $5$.</span> </p></center><p>You need to find the value of $x$. To do that, you can make queries of the following form:</p><ul> <li> $\texttt{?}~a~b$&nbsp;！ in response, we will measure the side lengths of an $a \times b$ rectangle with our ruler and multiply the results, reporting the measured area of the rectangle back to you. For example, if $x=4$ and you query a $3 \times 5$ rectangle, we will measure its side lengths as $3 \times 6$ and report $18$ back to you. </li></ul><p>Find the value of $x$. You can ask at most $\mathbf{7}$ queries.</p></div><div class="input-specification"><p>Each test contains multiple test cases. The first line of input contains a single integer $t$ ($1 \leq t \leq 1000$)&nbsp;！ the number of test cases.</p></div><div><h2>Interaction</h2><p>There is no initial input for each test case. You should begin the interaction by asking a query.</p><p>To make a query, output a single line of the form $\texttt{?}~a~b$ ($1 \leq a, b \leq 1000$). In response, you will be told the measured area of the rectangle, according to our secret ruler.</p><p>When you are ready to print the answer, output a single line of the form $\texttt{!}~x$ ($2 \leq x \leq 999$). After that, proceed to process the next test case or terminate the program if it was the last test case. Printing the answer does not count as a query.</p><p>The interactor is <span class="tex-font-style-bf">not</span> adaptive, meaning that the answer is known before the participant asks the queries and doesn't depend on the queries asked by the participant.</p><p>If your program makes more than $7$ queries for one set of input data, makes an invalid query, or prints the wrong value of $x$, then <span class="tex-font-style-bf">the response to the query will be</span> $-1$. After receiving such a response, your program should immediately terminate to receive the verdict <span class="tex-font-style-tt">Wrong Answer</span>. Otherwise, you can get an arbitrary verdict because your solution will continue to read from a closed stream.</p><p>After printing a query do not forget to output the end of line and flush the output. Otherwise, you may get <span class="tex-font-style-tt">Idleness limit exceeded</span> verdict. To do this, use: </p><ul> <li> <span class="tex-font-style-tt">fflush(stdout)</span> or <span class="tex-font-style-tt">cout.flush()</span> in C++; </li><li> <span class="tex-font-style-tt">System.out.flush()</span> in Java; </li><li> <span class="tex-font-style-tt">flush(output)</span> in Pascal; </li><li> <span class="tex-font-style-tt">stdout.flush()</span> in Python; </li><li> see the documentation for other languages. </li></ul><p><span class="tex-font-style-bf">Hacks</span></p><p>To make a hack, use the following format.</p><p>The first line should contain a single integer $t$ ($1 \leq t \leq 1000$)&nbsp;！ the number of test cases.</p><p>The only line of each test case should contain a single integer $x$ ($2 \leq x \leq 999$)&nbsp;！ the missing number on the ruler.</p></div>

## Input

<p>Each test contains multiple test cases. The first line of input contains a single integer $t$ ($1 \leq t \leq 1000$)&nbsp;！ the number of test cases.</p>





```input1
2

18

25


9999
```




```output1
? 3 5

? 4 4

! 4
? 99 100

! 100
```



## Note

<p>In the first test, the interaction proceeds as follows.</p><center> <table class="tex-tabular"><tbody><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Solution</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Jury</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Explanation</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{2}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">There are 2 test cases.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{? 3 5}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Secretly, the jury picked $x=4$. The solution requests the $3 \times 5$ rectangle, and the jury responds with $3 \times 6 = 18$, as described in the statement.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{? 4 4}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{25}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The solution requests the $4 \times 4$ rectangle, which the jury measures as $5 \times 5$ and responds with $25$.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{! 4}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The solution has somehow determined that $x=4$, and outputs it. Since the output is correct, the jury continues to the next test case.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{? 99 100}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Secretly, the jury picked $x=100$. The solution requests the $99 \times 100$ rectangle, which the jury measures as $99 \times 101$ and responds with $9999$.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{! 100}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The solution has somehow determined that $x=100$, and outputs it. Since the output is correct and there are no more test cases, the jury and the solution exit.</td></tr></tbody></table> </center><p>Note that the line breaks in the example input and output are for the sake of clarity, and do not occur in the real interaction.</p>
