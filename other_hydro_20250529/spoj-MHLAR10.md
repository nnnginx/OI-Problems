<p>&nbsp;</p>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; ">
<div style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; ">
<p>   </p>
</div>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<table style="cursor: default; width: 748px; background-color: #44c23c; font-size: 10px; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; border: 1px dashed #bbbbbb;" border="0">
<tbody>
<tr>
<td style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; cursor: text; text-align: center; margin: 8px; border: 1px dashed #bbbbbb;" width="50%"><a href="/problems/MTEMP/en/">English</a></td>
<td style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; cursor: text; text-align: center; margin: 8px; border: 1px dashed #bbbbbb;" width="50%"><a href="/problems/MTEMP/vn/">Vietnamese</a></td>
</tr>
</tbody>
</table>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; "></p>
<p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; ">&nbsp;</p>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">Gene and Gina have a particular kind of farm. Instead of growing animals and vegetables, as</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">it is usually the case in regular farms, they grow strings. A string is a sequence of characters.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">Strings have the particularity that, as they grow, they add characters to the left and/or to the</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">right of themselves, but they never lose characters, nor insert new characters in the middle.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">Gene and Gina have a collection of photos of some strings at diﬀerent times during their growth.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">The problem is that the collection is not annotated, so they forgot to which string each photo</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">belongs to. They want to put together a wall to illustrate strings growing procedures, but they</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">need your help to ﬁnd an appropriate sequence of photos.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">Each photo illustrates a string. The sequence of photos must be such that if si comes imme-</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">diately before si+1 in the sequence, then si+1 is a string that may have grown from si (i.e., si</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">appears as a consecutive substring of si+1). Also, they do not want to use repeated pictures,</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">so all strings in the sequence must be diﬀerent.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">Given a set of strings representing all available photos, your job is to calculate the size of the</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 448px; width: 1px; height: 1px; overflow: hidden; color: #000000; font-family: Verdana,Arial,Helvetica,sans-serif; font-size: 10px; border: 1px dashed #bbbbbb;">largest sequence they can produce following the guidelines above.</div>
<p>&nbsp;</p>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">Helen is a hyperactive girl. She wants to schedule her activities so that at any moment of the&nbsp;</span></span><span style="font-size: small;">day there is at least one thing she can do. She does not care if her activities overlap in time,&nbsp;</span><span style="font-size: small;">as long as every moment of her day has an activity scheduled.</span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">Helen divided the day in a particular way. The day starts at time 0 and ﬁnishes at time M.&nbsp;</span></span><span style="font-size: small;">Each moment of the day is represented by a real number between 0 and M, inclusive. Helen&nbsp;</span><span style="font-size: small;">made a list of all possible activities, with their start and ﬁnish times. Now she must decide&nbsp;</span><span style="font-size: small;">which subset of activities to schedule.</span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">If an activity starts at time S and ﬁnishes at time F, then we say that it covers all moments&nbsp;</span></span><span style="font-size: small;">between S and F, inclusive. Helen does not want to waste any activities, so she will only&nbsp;</span><span style="font-size: small;">choose minimal subsets of activities that cover the day to be scheduled. A subset of activities&nbsp;</span><span style="font-size: small;">is a minimal subset that covers the day if and only if:</span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">1. every moment of the day is covered by at least one activity of the subset; and</span></span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">2. removing any of the activities from the subset would leave at least one moment of the&nbsp;</span></span><span style="font-size: small;">day uncovered.</span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">Note that some moments of the day may be covered by more than one activity.</span></span></div>
<div style="background-image: initial; background-attachment: initial; background-origin: initial; background-clip: initial; background-color: #ffffff; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; text-align: justify; "><span><span style="font-size: small;">Given the list of possible activities for one day, you must help Helen by determining how many&nbsp;</span></span><span style="font-size: small;">distinct minimal subsets cover the day.</span></div>
<p>&nbsp;</p>
<h1 style="font-size: 2em; text-align: center; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">Input</h1>
<p style="color: #000000; "><span style="font-size: small;"><br></span></p>
<p style="text-align: justify; font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<p style="text-align: justify; font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; "><span><span style="font-size: small;">Each test case is given using several lines. The ﬁrst line contains two integers M and N,&nbsp;</span></span><span style="font-size: 10px;"><span style="font-size: 10px;"><span style="font-size: small;">representing respectively the highest value for a moment in the day (1 ≤ M ≤ 10^9</span></span><span style="font-size: small;">) and the&nbsp;</span><span style="font-size: small;">number of possible activities for the day (1 ≤ N ≤ 100). Each of the next N lines describes&nbsp;</span></span><span style="font-size: small;">one possible activity and contains two integers S and F, representing respectively the start and&nbsp;</span><span style="font-size: small;">ﬁnish times of the activity (0 ≤ S &lt; F ≤ M).</span></p>
<p style="text-align: justify; font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; "><span><span style="font-size: small;">The last test case is followed by a line containing two zeros.</span></span></p>
<p>&nbsp;</p>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<h1 style="font-size: 2em; text-align: center; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">Output</h1>
<p>&nbsp;</p>
<p style="text-align: justify; "><span style="font-size: small;">For each test case output a single line with a single integer representing the number of minimal&nbsp;</span><span style="font-size: small;">subsets that cover the day. To make your life easier, print the remainder of dividing the solution&nbsp;</span><span style="font-size: small;">by 10^8</span><span style="font-size: 10px;">.</span></p>
<p>&nbsp;</p>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
<h1 style="font-size: 2em; text-align: center; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">Sample</h1>
<pre style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; text-align: justify; margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 8px; "><span style="font-size: x-small;"><strong><span style="font-size: small;">input</span></strong><br></span><span style="font-size: small;">8 7
0 3
2 5
5 8
1 3
3 6
4 6
0 2
1 1
0 1
2 1
0 1
0 0</span><span style="font-size: x-small;"><span><br><br></span></span><strong><span style="font-size: small;">output</span></strong><span style="font-size: x-small;"><span><br></span></span><span style="font-size: small;">4
1
0</span></pre>
<p style="color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 10px; "> </p>
<p style="font-size: 10px; color: #000000; font-family: Verdana, Arial, Helvetica, sans-serif; ">&nbsp;</p>
</div>
<p>&nbsp;</p>