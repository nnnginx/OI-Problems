<pre><br><span style="white-space: normal;"><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>Statement</strong><br><br>Mario is one the most famous video games ever. In this problem, we will be helping Mario save the princess(again :P). In this game of mario, <strong>each world will be represented by a 2-D rectangular grid</strong>. There are <strong>multiple worlds</strong> and all the worlds are of size RxC. The world contains many objects each covering exactly one cell.&nbsp;<br><br>The cell with ¡®S¡¯ denotes Mario¡¯s starting position. A cell with ¡®.¡¯ denotes an empty cell over which Mario can walk safely. From that cell he can move to any of its 4 adjacent cells (which share an edge with it). A cell with ¡®D¡¯ denotes a pipe that leads to the world below. A cell with ¡®U¡¯ denotes a pipe that leads to the world above. If Mario enters a cell containing a pipe, he must enter the pipe. A cell with ¡®C¡¯ represents a coin and Mario collects these. After collecting the coin, the cell becomes an empty cell. A cell with ¡®#¡¯ denotes bricks and Mario can¡¯t enter this cell no matter what. A cell with ¡®M¡¯ denotes the monster(Bowser), Mario has to defeat Bowser to save the princess. Mario initially start from an empty cell.&nbsp;<br><br>Our Mario is very determined and so he will be always able to defeat Bowser on a 1 on 1 battle. But he is greedy and will always want to collect all the coins before going to save the princess. <strong>If he is not able to collect all the coins, he won¡¯t save the princess!</strong>. &nbsp;Help Mario to find the minimum number of steps to do this feat.&nbsp;</p>
<p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>Note:</strong><br>If ¡®U¡¯ is present in topmost world or ¡®D¡¯ is present in the bottommost world, Mario can¡¯t enter the cell.&nbsp;</p>
<p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>Input format:</strong><br><br>Input contains multiple test cases (will never exceed 1000).&nbsp;<br><br>First line of each test case will have 3 integers R, C and W.<br><br>¡®R X C¡¯ represents Grid dimension and ¡®W¡¯ represents number of worlds.<br>It will be followed by R X W lines. Each line will have ¡®C¡¯ characters.<br><br>First R lines describe the first world, second R lines describe the second world and so on upto W worlds.<br><br>Input ends by the line, ¡°0 0 0¡±.</p>
<p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>Output format:</strong><br><br>For each test case, print a single line ¡°Mario saved the princess in K steps¡± where K is the minimum number of steps if he defeat the monster else Print ¡°Mario failed to save princess¡±.</p>
<p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>constraints:</strong><br><br>1&lt;=R,C&lt;=15<br><br>1&lt;=W&lt;=10<br><br>0&lt;=[Total number of coins]&lt;=10<br><br>All characters in the grid will be from the set {¡®S¡¯, ¡®.¡¯, ¡®M¡¯, ¡®C¡¯, ¡®D¡¯, ¡®U¡¯, ¡®#¡¯ }&nbsp;<br><br><br><strong>INPUT:</strong><br><br>2 2 1</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">SM</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">.D</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">&nbsp;</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">2 2 2</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">SM</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">.D</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">C.</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">UC</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">&nbsp;</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">3 3 2</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">S.M</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">C#.</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">D..</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">###</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">C.C</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">C.U</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">&nbsp;</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">2 2 1</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">SM</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">#C</p>
<p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">0 0 0</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><strong>SAMPLE OUTPUT:</strong><br><br><span style="color: #444444; font-family: Arial, sans-serif; font-size: 12px; line-height: 18px; text-align: justify;">Mario saved the princess in 1 steps</span></p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><span style="color: #444444; font-family: Arial, sans-serif; font-size: 12px; line-height: 18px; text-align: justify;">Mario saved the princess in 7steps</span></p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;">Mario saved the princess in 8 steps</p><p style="font-family: Arial, sans-serif; margin: 7px 0px 0px; padding: 0px; font-size: 12px; line-height: 1.5em; color: #444444; text-align: justify;"><span style="color: #444444; font-family: Arial, sans-serif; font-size: 12px; line-height: 18px; text-align: justify;">Mario failed to save princess</span></p></span></pre>
<p>&nbsp;</p>
<p><strong>&nbsp; Explanation for third test case :&nbsp;</strong></p>
<p><strong>&nbsp;Mario is in (0,0, 1) (first world), the optimal path is&nbsp; (0,0,1) -&gt; (1, 0, 1) -&gt; (2, 0, 1) -&gt;(2, 0, 2) -&gt; (1, 0, 2) -&gt; (1, 1, 2) -&gt; (1, 2, 2) -&gt; (2, 2, 2) -&gt; (2, 2, 1) -&gt; (1, 2, 1) -&gt; (1, 2, 0). So totally 10 steps which includes 1 Up and 1 Down. As there is no manpower required for Mario to take step in between the worlds ommitting the 2 steps which gives us the answer 8.<br></strong></p>