## 题目背景
芙兰朵露・斯卡蕾特的符卡禁忌「四重存在」可以产生 $4$ 个芙兰的幻影。

但是芙兰并不满足于此。

## 题目描述
芙兰所处的地下室可以被抽象为一个巨大的平面直角坐标系。芙兰朵露会进行 $q$ 次行动，每次行动的形式如下：  

- `1 x y v` 表示芙兰在坐标 $(x,y)$ 处召唤出一个新的幻影，这个幻影拥有 $v$ 个单位的力量。  

- `2` 表示查询现有的幻影中，"**芙兰距离**"的最大值是多少。  

- `3 a` 表示查询如果忽略掉第 $a$ 个被召唤出的幻影，则剩余的幻影中"芙兰距离"的最大值是多少 。

注： 

记第 $i$ 个被召唤出的幻影编号为 $i$，坐标为 $(x_i,y_i)$，力量为 $v_i$。  

两个编号为 $u,v$ 的幻影间的"芙兰距离"等于 $|x_u-x_v|+|y_u-y_v|+v_{\max(u,v)}$。

**特殊地，编号为 $i$ 的幻影与自己的"芙兰距离"为 $v_i$。**  

$3$ 操作中第 $a$ 个召唤的幻影只是在本次询问中不参与运算，而不是被去除。

## 输入格式
第一行一个整数 $q$，表示操作个数。  

之后 $q$ 行，每行若干个整数，输入格式与题目描述一致。 

**注意**：由于芙兰朵露的情绪并不稳定，因此在 $1$ 操作中，实际输入的 

$$x'=x \operatorname{ xor } (\text{lastans} \bmod 3)$$

$$y'=y \operatorname{ xor } (\text{lastans} \bmod 3)$$

$$v'=v \operatorname{ xor } (\text{lastans} \bmod 3)$$   

其中的运算含义如下：

- $\operatorname{xor}$ 表示异或运算。

- $\text{lastans}$ 表示上一次 $2$ 或 $3$ 操作的答案，初始时 $\text{lastans}=0$ 

## 输出格式
输出一共若干行，每行一个整数，为每个 $2$ 操作或 $3$ 操作的答案。

```input1
6
1 4 -4 0
1 -3 -1 0
1 -1 -1 0
2
3 2
3 3
```

```output1
10
8
10

```

## 提示
#### 数据范围与约定

**「本题采用捆绑测试：一个子任务通过，当且仅当该子任务中全部测试点通过」。**

| 子任务编号 | $q \le$ | 特殊性质 | 分值 |
| :----------: | :-------: | :--------: | :---: |
| $1$ | $500$ | 无 | $5$ |
| $2$ | $5 \times 10^3$ | A | $10$ |
| $3$ | $10^5$ | A | $20$ |
| $4$ | $10^5$ | 无 | $25$ |
| $5$ | $2 \times 10^6$ | 无 | $40$ |

其中性质 A 表示无 3 操作。

对于 $100\%$ 的数据，$-10^8 \le x,y,v \le 10^8$，记某一时刻幻影的数量为 $c$，则有 $1 \le a \le c$ 。

数据保证任意两个幻影的坐标不同，且在询问 $2,3$ 时至少已经插入 $3$ 个点。

