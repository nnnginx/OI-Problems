## Description

<div><p><span class="tex-font-style-bf">This is the hard version of the problem. In this version, the limit of commands you can send is described in the statement. You can make hacks only if all versions of the problem are solved.</span></p><p><span class="tex-font-style-it">This is an interactive problem.</span></p><p>Welcome, Duelists! In this interactive challenge, there is an unknown integer $x$ ($1 \le x \le 10^9$). You must make it equal to a given integer in the input $n$. By harnessing the power of "Mathmech" monsters, you can send a command to do one of the following:</p><center> <table class="tex-tabular"><tbody><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Command</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Constraint</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Result</span></td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Case</span></td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Update</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-bf">Jury's response</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2"><span class="tex-font-style-tt">"add $y$"</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$-10^{18} \le y \le 10^{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$\mathrm{res} = x + y$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\text{if } 1 \le \mathrm{res} \le 10^{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow \mathrm{res}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"1"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\mathrm{else}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow x$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"0"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2"><span class="tex-font-style-tt">"mul $y$"</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$1 \le y \le 10^{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$\mathrm{res} = x \cdot y$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\text{if } 1 \le \mathrm{res} \le 10^{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow \mathrm{res}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"1"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\mathrm{else}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow x$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"0"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2"><span class="tex-font-style-tt">"div $y$"</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$1 \le y \le 10^{18}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom" rowspan="2">$\mathrm{res} = x/y$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\text{if } y$ divides $x$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow \mathrm{res}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"1"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\mathrm{else}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow x$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"0"</span></td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"digit"</span></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">—</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\mathrm{res} = S(x)$$^{\text{∗}}$</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">—</td><td class="tex-tabular-border-left tex-tabular-text-align-left tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$x \leftarrow \mathrm{res}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"><span class="tex-font-style-tt">"1"</span></td></tr></tbody></table> </center><p>Let $f(n)$ be the minimum integer such that there is a sequence of $f(n)$ commands that transforms $x$ into $n$ for all $x(1 \le x \le 10^9)$. You do not know the value of $x$ in advance. Find $f(n)$ such that, no matter what $x$ is, you can always transform it into $n$ using at most $f(n)$ commands.</p><p>Your task is to change $x$ into $n$ using <span class="tex-font-style-bf">at most</span> $f(n)$ commands.</p><div class="statement-footnote"><p>$^{\text{∗}}$$S(n)$ is a function that returns the sum of all the individual digits of a non-negative integer $n$. For example, $S(123) = 1 + 2 + 3 = 6$</p></div></div><div class="input-specification"><p>Each test contains multiple test cases. The first line contains the number of test cases $t$ ($1 \le t \le 5000$). The description of the test cases follows. </p><p>The first and only line of each test case contains one integer $n$ ($1 \le n \le 10^9$).</p></div><div><h2>Interaction</h2><p>The interaction for each test case begins by reading the integer $n$.</p><p>To send a command, output a line in the following format:</p><ul> <li> <span class="tex-font-style-tt">"add $y$"</span> Add some integer $y$ ($-10^{18} \le y \le 10^{18}$) to $x$.<p> The jury will output <span class="tex-font-style-tt">"1"</span> if $x + y$ is within $[1, 10^{18}]$ (<span class="tex-font-style-bf">successful</span>), and <span class="tex-font-style-tt">"0"</span> otherwise. If successful, update $x \leftarrow x + y$.</p></li><li> <span class="tex-font-style-tt">"mul $y$"</span> Multiply $x$ by a positive integer $y$ ($1 \le y \le 10^{18}$).<p> The jury will output <span class="tex-font-style-tt">"1"</span> if $x \cdot y$ is within $[1, 10^{18}]$ (<span class="tex-font-style-bf">successful</span>), and <span class="tex-font-style-tt">"0"</span> otherwise. If successful, update $x \leftarrow x \cdot y$.</p></li><li> <span class="tex-font-style-tt">"div $y$"</span> Divide $x$ by a positive integer $y$ ($1 \le y \le 10^{18}$).<p> The jury will output <span class="tex-font-style-tt">"1"</span> if $y$ is a divisor of $x$ (<span class="tex-font-style-bf">successful</span>), and <span class="tex-font-style-tt">"0"</span> otherwise. If successful, update $x \leftarrow \frac{x}{y}$.</p></li><li> <span class="tex-font-style-tt">"digit"</span> Make $x$ equal to the sum of its digits.<p> The jury will always output <span class="tex-font-style-tt">"1"</span> and update $x \leftarrow S(x)$.</p></li></ul><p>Note that commands are <span class="tex-font-style-bf">case sensitive</span>. </p><p>When you have determined that $x$ is equal to $n$, output a line in the following format:</p><ul> <li> <span class="tex-font-style-tt">"!"</span> — where the jury will output a <span class="tex-font-style-tt">"1"</span> if $n$ is equal to $x$, and <span class="tex-font-style-tt">"-1"</span> otherwise. </li></ul><p>Note that answering <span class="tex-font-style-bf">does not count</span> toward your limit of commands.</p><p>If your program makes more than $f(n)$ commands ($f(n)$ is described above) for one test case, or makes an invalid command, then the response to the command will be <span class="tex-font-style-tt">"-1"</span>. After receiving such a response, your program should immediately terminate to receive the verdict <span class="tex-font-style-bf">Wrong Answer</span>. Otherwise, it may receive any other verdict.</p><p>After printing a command, do not forget to output the end of the line and flush the output. Otherwise, you will get <span class="tex-font-style-tt">Idleness limit exceeded</span>. To do this, use:</p><ul> <li> <span class="tex-font-style-tt">fflush(stdout)</span> or <span class="tex-font-style-tt">cout.flush()</span> in C++; </li><li> <span class="tex-font-style-tt">System.out.flush()</span> in Java; </li><li> <span class="tex-font-style-tt">sys.stdout.flush()</span> in Python; </li><li> <span class="tex-font-style-tt">std::io::stdout().flush()</span> in Rust; </li><li> see the documentation for other languages. </li></ul><p>The interactor is <span class="tex-font-style-bf">non-adaptive</span>. The unknown integer $x$ <span class="tex-font-style-bf">does not change</span> during the interaction.</p><p><span class="tex-font-style-bf">Hacks</span></p><p>To hack, use the following format.</p><p>The first line should contain a single integer $t$ ($1 \leq t \leq 5000$) — the number of test cases.</p><p>The first line of each test case should contain two positive integers $n$ and $x$ ($1 \leq n,x \leq 10^9$) — denoting the unknown integer and the target value to which it should be made equal, respectively.</p></div>

## Input

<p>Each test contains multiple test cases. The first line contains the number of test cases $t$ ($1 \le t \le 5000$). The description of the test cases follows. </p><p>The first and only line of each test case contains one integer $n$ ($1 \le n \le 10^9$).</p>





```input1
2
100

0

1

1

1

5

1

1

1
```




```output1
add -10

add 1

mul 10

!

digit

div 2

!
```



## Note

<center> <table class="tex-tabular"><tbody><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Solution</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Jury</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">Explanation</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{2}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">There are 2 test cases.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{100}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">In the first test case, the unknown integer $x = 9$ and we have to make it equal to $n = 100$.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{add -10}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{0}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"add -10"</span> is <span class="tex-font-style-tt">"0"</span>. This means that the addition command was not successful as $x + y = 9 + (-10) \le 0$, and $x$ remains $9$ after the command</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{add 1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"add 1"</span> is <span class="tex-font-style-tt">"1"</span>. This means that the addition command was successful as $x + y = 9 + 1 = 10$, and $x$ changes to $10$ after the command.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{mul 10}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"mul 10"</span> is <span class="tex-font-style-tt">"1"</span>. This means that the multiplication command was successful as $x \cdot y = 10 \cdot 10 = 100$, and $x$ changes to $100$ after the command.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{!}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"!"</span> is <span class="tex-font-style-tt">"1"</span>. This means you have determined that $x$ equals $n$.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom"></td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{5}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">In the second test case, the unknown integer $x = 1234$ and we have to make it equal to $n = 5$.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{digit}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"digit"</span> is <span class="tex-font-style-tt">"1"</span>. This means that $x$ turned into the sum of its digits $1 + 2 + 3 + 4 = 10$, and $x$ changes to $10$ after the command.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{div 2}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"div 2"</span> is <span class="tex-font-style-tt">"1"</span>. This means that the division command was successful as $y = 2$ is a divisor of $x = 10$, and $x$ changes to $\frac{x}{y} = \frac{10}{2} = 5$ after the command.</td></tr><tr><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{!}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">$\texttt{1}$</td><td class="tex-tabular-border-left tex-tabular-text-align-center tex-tabular-border-right tex-tabular-border-top tex-tabular-border-bottom">The answer to <span class="tex-font-style-tt">"!"</span> is <span class="tex-font-style-tt">"1"</span>. This means you have determined that $x$ equals $n$.</td></tr></tbody></table> </center><p>Note that the empty lines in the example input and output are for the sake of clarity, and do not occur in the real interaction.</p>
