<p><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">Let us define a&nbsp;</span><strong>Magical number</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">&nbsp;as a positive integer number which meets the following criteria on its representation:</span></p>
<pre style="padding: 9.5px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; color: #333333; border-radius: 4px; margin: 0px 0px 20px; line-height: 20px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; background-color: #f5f5f5; border: 1px solid rgba(0, 0, 0, 0.15);"><code style="padding: 0px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: inherit; border-radius: 3px; background-color: transparent; border: 0px;">1.) It does not contain any zeros.
2.) Each digits may appears at most twice in it.
3.) The absolute differences between summation of count of non-prime digits and count of prime-digits do not exceed K.
</code></pre>
<p style="margin: 0px 0px 12px; line-height: 21px; color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">Sanvi likes numbers which are not prime. So,&nbsp;<strong>she wants to allow at most M non prime numbers to violate the rule number-2</strong>&nbsp;. Sanvi also uses following algorithm in rule number-3 to calculate count of each digit&nbsp;<strong>d</strong>&nbsp;in a number:</p>
<pre style="padding: 9.5px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 13px; color: #333333; border-radius: 4px; margin: 0px 0px 20px; line-height: 20px; word-break: break-all; word-wrap: break-word; white-space: pre-wrap; background-color: #f5f5f5; border: 1px solid rgba(0, 0, 0, 0.15);"><code style="padding: 0px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: inherit; border-radius: 3px; background-color: transparent; border: 0px;">count( d ) = min( total occurrences of d in number, 2 )
</code></pre>
<p style="margin: 0px 0px 12px; line-height: 21px; color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">You are given an integer number&nbsp;<strong>N</strong>. Your task is to find the total Magical numbers in the range from&nbsp;<strong>1</strong>&nbsp;to&nbsp;<strong>N&nbsp;</strong>following Sanvi's command. Since the answer could be very large, print it modulo <strong>10^9+7</strong>.</p>
<h3>Input</h3>
<p><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">Input contains several test cases up to&nbsp;</span><strong>EOF</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">&nbsp;(End Of File), which contains three space separated integers&nbsp;</span><strong>N ( 1 ¡Ü N ¡Ü 10^18 ) , K( 0¡Ü K¡Ü 18 ) and M( 0 ¡Ü M ¡Ü 5 )</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">&nbsp;as described in the problem statement.Total test cases will not exceed&nbsp;</span><strong>5</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">.</span></p>
<h3>Output</h3>
<p><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">Output a single integer denoting the total Magical numbers from&nbsp;</span><strong>1 to N following Sanvi's command</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">&nbsp;. Since the answer could be very large print it modulo&nbsp;</span><strong>10^9+7</strong><span style="color: #333333; font-family: &quot;Open Sans&quot;, Tahoma, Geneva, Verdana, sans-serif; font-size: 14px;">.</span></p>
<h3>Example</h3>
<pre><strong>Input:</strong></pre>
<pre><strong>10 1 0<br></strong><strong>5 3 2 </strong></pre>
<pre><strong>Output:</strong></pre>
<pre><strong>9<br></strong><strong>5</strong></pre>
<pre><strong><div id="_mcePaste" style="position: absolute; left: -10000px; top: 221.6px; width: 1px; height: 1px; overflow: hidden;">9</div><div id="_mcePaste" style="position: absolute; left: -10000px; top: 221.6px; width: 1px; height: 1px; overflow: hidden;">5</div><div id="_mcePaste" style="position: absolute; left: -10000px; top: 221.6px; width: 1px; height: 1px; overflow: hidden;">9</div></strong></pre>