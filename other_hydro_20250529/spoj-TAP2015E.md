<p><span style="font-weight: bold;">[Due to SPOJ restrictions, this problem has been modified with respect to the original version used in the Argentinian Programming Tournament of 2015 in order to have multiple test cases per input file. The original version of this problem (in Spanish) can be found at </span><a style="font-weight: bold;" href="http://torneoprogramacion.com.ar/wp-content/uploads/2015/09/pruebaTAP2015.pdf">http://torneoprogramacion.com.ar/wp-content/uploads/2015/09/pruebaTAP2015.pdf</a><span style="font-weight: bold;"> ]</span></p>
<p>One of the most difficult stages to automate in an industrial cookie production line is the one corresponding to packing. The goal is to design an apparatus capable of counting a precise number <strong>G</strong> of cookies to be put in a package, and the challenge resides in the fact that the cookies may have markedly different shapes, <em>e.g.</em> of various animals.</p>
<p>In the cookie factory where you work the design team has been unable to overcome these difficulties. The best design they have achieved corresponds to a counting machine which, when activated, can select <strong>C<sub>i</sub></strong>&nbsp;cookies with probability <strong>P<sub>i</sub></strong>&nbsp;for <strong>i = 1, 2, ..., K</strong>. Having already spent the entire budget allocated to this task, you will have to find a way to make something useful out of this.</p>
<p>Fortunately, you have come up with the following idea to save the project. You shall build an automated packager using <strong>N</strong> counting machines such as the one described above, along with a special regulating software that will perform the following process iteratively. Before starting the first iteration the <strong>N</strong> counting machines are activated, each one selecting certain number of cookies. In each iteration, the software will choose a non-empty subset <strong>S</strong> of the <strong>N</strong> machines such that the sum of the selected cookies is as close as possible to the desired value <strong>G</strong> (in the sense that the absolute value of the difference between this number and <strong>G</strong> is minimum). If there is more than one subset satisfying this condition, the software will choose as <strong>S</strong> any of them with uniform probability. The cookies selected by the counting machines in <strong>S</strong> will then be removed and packed together. Finally, each of the machines in <strong>S</strong> will be activated again in order for it to select certain number of cookies, while the counting machines not in <strong>S</strong> remain unaltered (that is, with the number of cookies they selected in the previous iteration). This process will be repeated until the desired number <strong>M</strong> of packages has been obtained.</p>
<p>For example, let's assume there are <strong>N = 3</strong> counting machines, which we will call <strong>m<sub>1</sub>, m<sub>2</sub></strong>&nbsp;and <strong>m<sub>3</sub></strong>, having each of them the possibility to select <strong>C<sub>1</sub>&nbsp;= 1</strong> or <strong>C<sub>2</sub>&nbsp;= 2</strong> cookies with probability <strong>P<sub>1</sub>&nbsp;= P<sub>2</sub>&nbsp;= ½</strong>. If we want to produce <strong>M = 2</strong> packages with <strong>G = 5</strong> cookies per package, a possible turn of events is the following. Before starting, the three machines select <strong>C<sub>2</sub>&nbsp;= 2</strong> cookies each (this will happen with probability <strong>½ * ½ * ½ = ⅛</strong>). In the first iteration, the software can then choose among the subsets <strong>{m<sub>1</sub>, m<sub>2</sub>, m<sub>3</sub>}</strong>, <strong>{m<sub>1</sub>, m<sub>2</sub>}</strong>, <strong>{m<sub>1</sub>, m<sub>3</sub>}</strong> and <strong>{m<sub>2</sub>, m<sub>3</sub>}</strong>, each with probability <strong>¼</strong> because they all have a difference of one cookie with the desired number <strong>G = 5</strong>. Supposing that the subset <strong>S = {m<sub>2</sub>, m<sub>3</sub>}</strong> is chosen, then the four cookies selected by machines <strong>m<sub>2</sub></strong>&nbsp;and <strong>m<sub>3</sub></strong>&nbsp;will be packed together. These machines will then be activated again, resulting for example in <strong>m<sub>2</sub></strong>&nbsp;selecting <strong>C<sub>1</sub>&nbsp;= 1</strong> cookie and <strong>m<sub>3</sub></strong>&nbsp;selecting <strong>C<sub>2</sub>&nbsp;= 2</strong> cookies (which will occur with probability <strong>½ * ½ = ¼</strong>). At this point the first iteration ends, the counting machines <strong>m<sub>1</sub></strong>, <strong>m<sub>2</sub></strong>&nbsp;and <strong>m<sub>3</sub></strong>&nbsp;having selected <strong>2, 1</strong> and <strong>2</strong> cookies respectively. In the second iteration, the software must necessarily choose the subset <strong>S = {m<sub>1</sub>, m<sub>2</sub>, m<sub>3</sub>}</strong> as it contains exactly five cookies, which will therefore be packed together. Finally, the three counting machines will be activated once more and the process will end, having produced the <strong>M = 2</strong> desired packages. Note that the net probability for the process here described is <strong>⅛ * ¼ * ¼ = 1/128</strong>, and that the average number of cookies per package is in this case <strong>4.5</strong> (because two packages were produced, one of them having four and the other five cookies).</p>
<p>Your boss is not completely convinced that this system will work, so he requires from you some concrete proof of concept. To convince him, it will suffice to calculate the expected number of cookies per package after producing <strong>M</strong> packages consecutively, if you assume that the <strong>N</strong> counting machines always select cookies according to the given probabilities.</p>
<p>&nbsp;</p>
<h3>Input</h3>
<p>There are multiple test cases in the input file. For each test case, the first line contains four integers <strong>N, K, G</strong> and <strong>M</strong>. The value <strong>N</strong> represents the number of counting machines to use (<strong>1 ≤ N ≤ 4</strong>), <strong>K</strong> represents the number of possible quantities of cookies each counting machine can select (<strong>1 ≤ K ≤ 6</strong>), <strong>G</strong> represents the desired number of cookies per package (<strong>1 ≤ G ≤ 100</strong>), and <strong>M</strong> represents the total number of packages to produce (<strong>1 ≤ M ≤ 10<sup>7</sup></strong>). Each of the following <strong>K</strong> lines contains an integer <strong>C<sub>i</sub></strong>&nbsp;and a rational <strong>P<sub>i</sub></strong>, indicating that the counting machines will select <strong>C<sub>i</sub></strong>&nbsp;cookies with probability <strong>P<sub>i</sub></strong>&nbsp;(<strong>1 ≤ C<sub>i</sub>&nbsp;≤ 100</strong> and <strong>0 &lt; P<sub>i</sub> ≤ 1</strong> for <strong>i = 1, 2, ..., K</strong>, being <strong>P<sub>i</sub></strong>&nbsp;given with exactly two digits after the decimal marker). Note that <strong>C<sub>i</sub>&nbsp;≠ C<sub>j&nbsp;</sub></strong>for <strong>i ≠ j</strong> and that <strong>∑ P<sub>i</sub>&nbsp;= 1</strong>.</p>
<p>&nbsp;</p>
<h3>Output</h3>
<p>For each test case, print one line containing a rational representing the expected number of cookies per package after having produced <strong>M</strong> packages as described in the problem statement. Print the result with exactly <strong>6</strong> digits after the decimal marker, rounding if necessary.</p>
<p>&nbsp;</p>
<h3>Example</h3>
<pre><strong>Input:</strong>
<span style="font-family: 'courier new', courier;">3 2 5 1
1 0.50
2 0.50
3 2 5 2
1 0.50
2 0.50</span>

<strong>Output:</strong>
<span style="font-family: 'courier new', courier;">4.312500
4.327148</span><span style="white-space: normal;">
</span></pre>