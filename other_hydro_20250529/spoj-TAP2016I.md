<p><strong>[Due to SPOJ restrictions, this problem has been modified with respect to the original version used in the Argentinian Programming Tournament of 2016 in order to have multiple test cases per input file. The original version of this problem (in Spanish) can be found at <a href="http://torneoprogramacion.com.ar/wp-content/uploads/2016/09/tap2016.pdf">http://torneoprogramacion.com.ar/wp-content/uploads/2016/09/tap2016.pdf</a> ]</strong></p>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">Ignacio liked to take part in programming competitions such as the Argentinian Programming Tournament during his years as a university student. He was very happy, and when he graduated he got a good job. However, with time routine and life in the big city started to make him feel uneasy. So one day he decided to move to the countryside and start a new life as a farmer. He hadn't saved a lot of money, but it was enough to buy a circular field.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">His life as a farmer didn't have a good start, as tragedy came before being able to enjoy his first crop. In the middle of his field a scarecrow was in charge of keeping birds at bay, but for some strange reason it was connected to a radioactive gas pipe coming from a nuclear plant close by. One morning the pipe broke and the gas escaped, destroying most of his field. Ignacio couldn't do anything about it, so only a thin strip on the border of his field remained intact. But that was not all, as the few surviving plants were soon attacked by a swarm of mutant insects. This time Ignacio wouldn't stand still, so he decided to fight the insect invasion with trained frogs.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">On the perimeter of his circular field he created $N$ ponds for the frogs, which he numberd from $1$ to $N$ in clockwise order. Then he bought $R$ frogs in a shop specializing in trained circus frogs, and numbered them from $1$ to $R$. During the night he put the frogs in the ponds, placing the $i$-th frog in pond number $B_i$. The frogs are very well trained, so at first light they will start to jump at a rate of one jump per minute. Each frog repeats a pattern of jumps every $K$ minutes. The $i$-th frog will jump advancing $A_{i,1}$ ponds in clockwise order during the first minute; it will then jump advancing $A_{i,2}$ ponds in the same direction, and so on until the $K$-th minute, in which it will jump advancing $A_{i,K}$ ponds. After that, the same pattern will be repeated, advancing $A_{i,1}$ ponds in the $K+1$-th minute, $A_{i,2}$ ponds in the $K+2$-th minute, etc. For example, let's consider the case with $N=5$ ponds and $K=3$. In this case, if frog number $1$ starts in pond $B_1 = 2$, being its jumping pattern $A_{1,1}=1$, $A_{1,2}=2$ and $A_{1,3}=1$, during its fist few jumps it will land in the ponds in the following order: $2$, $3$, $5$, $1$, $2$, $4$, $5$, $1$, $3$, $4$, $5$, \dots.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">Ignacio is really quite unlucky, because the first frog suffers from an contagious disease which has turned it into a vegetarian. When the sun comes out and all the frogs start jumping, if a sick frog meets a healthy one in some pond, it will transmit it with this disease. In our example with $N = 5$ and $K = 3$ if there are $R = 2$ frogs and the second frog starts at pond $B_2 = 4$ with a jumping pattern given by $A_{2,1}=1$, $A_{2,2}=1$ and $A_{2,3}=1$, it will visit the ponds in the order 4, 5, 1, 2, 3, 4, $\ldots$. Therefore, the first frog will transmit its disease to the second one after $5$ minutes, when both meet at pond number $4$. Generically, more and more frogs will get infected until either all of them are sick, or the remaining healthy frogs never meet with the sick ones, reaching at that point the maximum number of infected frogs.</div>
<div id="_mcePaste" style="position: absolute; left: -10000px; top: 0px; width: 1px; height: 1px; overflow: hidden;">While writing this story the night has gone by, and even if Ignacio noticed that the first frog is sick, he is now unable to catch it because it is trained so well. He will have to go directly to the trained circus frog shop to complain. As he wants to ask for a refund, he should wait until the disease spreads completely, reaching the maximum number of infected frogs. Ignacio doesn't want to wait longer than necessary, so in order to help him you should answer two questions: What is the maximum number of infected frogs? In which minute will the last transmission of the sickness take pla</div>
<p>Ignacio liked to take part in programming competitions such as the Argentinian Programming Tournament during his years as a university student. He was very happy, and when he graduated he got a good job. However, with time routine and life in the big city started to make him feel uneasy. So one day he decided to move to the countryside and start a new life as a farmer. He hadn't saved a lot of money, but it was enough to buy a circular field.</p>
<p>His life as a farmer didn't have a good start, as tragedy came before being able to enjoy his first crop. In the middle of his field a scarecrow was in charge of keeping birds at bay, but for some strange reason it was connected to a radioactive gas pipe coming from a nuclear plant close by. One morning the pipe broke and the gas escaped, destroying most of his field. Ignacio couldn't do anything about it, so only a thin strip on the border of his field remained intact. But that was not all, as the few surviving plants were soon attacked by a swarm of mutant insects. This time Ignacio wouldn't stand still, so he decided to fight the insect invasion with trained frogs.</p>
<p>On the perimeter of his circular field he created <strong>N</strong>&nbsp;ponds for the frogs, which he numberd from <strong>1</strong>&nbsp;to <strong>N</strong>&nbsp;in clockwise order. Then he bought <strong>R</strong>&nbsp;frogs in a shop specializing in trained circus frogs, and numbered them from <strong>1</strong>&nbsp;to <strong>R</strong>. During the night he put the frogs in the ponds, placing the <strong>i</strong>-th frog in pond number <strong>B<sub>i</sub></strong>. The frogs are very well trained, so at first light they will start to jump at a rate of one jump per minute. Each frog repeats a pattern of jumps every <strong>K</strong>&nbsp;minutes. The <strong>i</strong>-th frog will jump advancing <strong>A<sub>i,1</sub></strong>&nbsp;ponds in clockwise direction during the first minute; it will then jump advancing <strong>A<sub>i,2</sub></strong>ponds in the same direction, and so on until the <strong>K</strong>-th minute, in which it will jump advancing <strong>A<sub>i,K</sub></strong>&nbsp;ponds. After that, the same pattern will be repeated, advancing <strong>A<sub>i,1</sub></strong>&nbsp;ponds in the <strong>K+1</strong>-th minute, <strong>A<sub>i,2</sub></strong>&nbsp;ponds in the <strong>K+2</strong>-th minute, etc. For example, let's consider the case with <strong>N = 5</strong>&nbsp;ponds and <strong>K = 3</strong>. In this case, if frog number <strong>1</strong>&nbsp;starts in pond <strong>B<sub>1</sub> = 2</strong>, being its jumping pattern <strong>A<sub>1,1</sub> = 1</strong>, <strong>A<sub>1,2</sub> = 2</strong>&nbsp;and <strong>A<sub>1,3</sub> = 1</strong>, during its fist few jumps it will land in the ponds in the following order: <strong>2</strong>, <strong>3</strong>, <strong>5</strong>, <strong>1</strong>, <strong>2</strong>, <strong>4</strong>, <strong>5</strong>, <strong>1</strong>, <strong>3</strong>, <strong>4</strong>, <strong>5</strong>, ...</p>
<p>Ignacio is really quite unlucky, because the first frog suffers from a contagious disease which has turned it into a vegetarian. When the sun comes out and all the frogs start jumping, if a sick frog meets a healthy one in some pond, it will transmit it this disease. In our example with <strong>N = 5</strong>&nbsp;and <strong>K = 3</strong>&nbsp;if there are <strong>R = 2</strong>&nbsp;frogs and the second frog starts at pond <strong>B<sub>2</sub> = 4</strong>&nbsp;with a jumping pattern given by <strong>A<sub>2,1</sub> = 1</strong>, <strong>A<sub>2,2</sub> = 1</strong>&nbsp;and <strong>A<sub>2,3</sub> = 1</strong>, it will visit the ponds in the order <strong>4</strong>, <strong>5</strong>,<strong> 1</strong>,<strong> 2</strong>,<strong> 3</strong>,<strong> 4</strong>, ... . Therefore, the first frog will transmit its disease to the second one after <strong>5</strong>&nbsp;minutes, when both meet at pond number <strong>4</strong>. Generically, more and more frogs will get infected until either all of them are sick, or the remaining healthy frogs never meet with the sick ones, reaching at that point the maximum number of infected frogs.</p>
<p>While writing this story the night has gone by, and even if Ignacio noticed that the first frog is sick, he is now unable to catch it because it is trained so well. He will have to go directly to the trained circus frog shop to complain. As he wants to ask for a refund, he should wait until the disease spreads completely, reaching the maximum number of infected frogs. Ignacio doesn't want to wait longer than necessary, so in order to help him you should answer two questions: What is the maximum number of infected frogs? In which minute will the last transmission of the sickness take place?</p>
<h3>Input</h3>
<p>There are multiple test cases in the input file. For each test case, the first line contains three integer numbers <strong>N</strong>, <strong>R</strong>&nbsp;and <strong>K</strong>. The integer <strong>N</strong>&nbsp;represents the number of ponds in the field (<strong>2 ¡Ü&nbsp;N&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;10<sup>9</sup></strong>), <strong>R</strong>&nbsp;represents the number of frogs (<strong>2&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;R&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;200</strong>) and <strong>K</strong>&nbsp;represents the number of minutes after which the frogs repeat their jumping pattern (<strong>1&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;K&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;200</strong>). The second line contains <strong>R</strong>&nbsp;integer numbers <strong>B<sub>1</sub></strong>, <strong>B<sub>2</sub></strong>, ..., <strong>B<sub>R</sub></strong>, representing the <strong>i</strong>-th number the initial position of the <strong>i</strong>-th frog (<strong>1&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;B_i&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;N</strong>&nbsp;for <strong>i = 1, ..., R</strong>, with <strong>B<sub>i</sub>¡Ù&nbsp;B<sub>j</sub></strong>&nbsp;if <strong>i&nbsp;</strong><strong>¡Ù</strong><strong>&nbsp;j</strong>). The following <strong>R</strong>&nbsp;lines describe the behavior of the frogs. The <strong>i</strong>-th of these lines contains <strong>K</strong>&nbsp;integer numbers <strong>A<sub>i,1</sub></strong>, <strong>A<sub>i,2</sub></strong>, ..., <strong>A<sub>i,K</sub></strong>, representing the number of ponds the <strong>i</strong>-th frog advances in each of its <strong>K</strong>&nbsp;jumps, in the order in which they occur (<strong>1&nbsp;</strong><strong>¡Ü</strong><strong>&nbsp;A<sub>i,j</sub> &lt; N</strong>&nbsp;for <strong>i = 1, 2, ..., R</strong>&nbsp;and <strong>j = 1, 2, ..., K</strong>).</p>
<p>&nbsp;</p>
<h3>Output</h3>
<p>For each test case, print a single line containig two integer numbers, representing the maximum number of infected frogs and the minute in which the last transmission of the disease takes place, respectively.</p>
<p>&nbsp;</p>
<h3>Example</h3>
<pre><strong>Input:</strong>
<span style="font-family: &quot;courier new&quot;, courier;">5 2 3
2 4
1 2 1
1 1 1
1234 4 4
23 25 1000 67
20 4 26 222
18 28 1232 222
2 4 6 222
2 2 2 2
2 2 1
1 2
1
1</span>

<strong>Output:</strong>
<span style="font-family: &quot;courier new&quot;, courier;">2 5
3 2
1 0</span></pre>